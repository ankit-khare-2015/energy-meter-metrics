[0m11:53:32.450287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb814520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb814580>]}


============================== 11:53:32.460312 | 332a5902-ca68-46cc-b10c-d95881f71760 ==============================
[0m11:53:32.460312 [info ] [MainThread]: Running with dbt=1.7.7
[0m11:53:32.461103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:32.461661 [info ] [MainThread]: dbt version: 1.7.7
[0m11:53:32.462085 [info ] [MainThread]: python version: 3.10.7
[0m11:53:32.462524 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:53:32.462851 [info ] [MainThread]: os info: Linux-6.10.11-linuxkit-x86_64-with-glibc2.31
[0m11:53:32.463311 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:53:32.463721 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:53:32.464127 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:53:32.525093 [info ] [MainThread]: Configuration:
[0m11:53:32.525691 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:53:32.526106 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:53:32.526534 [info ] [MainThread]: Required dependencies:
[0m11:53:32.527030 [debug] [MainThread]: Executing "git --help"
[0m11:53:32.547170 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:53:32.547974 [debug] [MainThread]: STDERR: "b''"
[0m11:53:32.548351 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:53:32.548811 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:53:32.549402 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:53:32.549800 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:53:32.551437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcdabca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd17670>]}
[0m11:53:32.551906 [debug] [MainThread]: Flushing usage events
[0m11:56:58.427807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82bf40>]}


============================== 11:56:58.439477 | 92d7bf0f-0215-4eb7-93c3-c5f125be3f01 ==============================
[0m11:56:58.439477 [info ] [MainThread]: Running with dbt=1.7.7
[0m11:56:58.440325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:56:58.440889 [info ] [MainThread]: dbt version: 1.7.7
[0m11:56:58.441302 [info ] [MainThread]: python version: 3.10.7
[0m11:56:58.441688 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:56:58.442073 [info ] [MainThread]: os info: Linux-6.10.11-linuxkit-x86_64-with-glibc2.31
[0m11:56:58.508339 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:56:58.508914 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:56:58.509367 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:56:58.509881 [info ] [MainThread]: adapter type: postgres
[0m11:56:58.510299 [info ] [MainThread]: adapter version: 1.7.7
[0m11:56:58.562788 [info ] [MainThread]: Configuration:
[0m11:56:58.563400 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:56:58.563827 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:56:58.564202 [info ] [MainThread]: Required dependencies:
[0m11:56:58.564693 [debug] [MainThread]: Executing "git --help"
[0m11:56:58.581340 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:56:58.581957 [debug] [MainThread]: STDERR: "b''"
[0m11:56:58.582271 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:56:58.582644 [info ] [MainThread]: Connection:
[0m11:56:58.583040 [info ] [MainThread]:   host: postgres
[0m11:56:58.583403 [info ] [MainThread]:   port: 5432
[0m11:56:58.583764 [info ] [MainThread]:   user: dbtuser
[0m11:56:58.584106 [info ] [MainThread]:   database: analytics
[0m11:56:58.584453 [info ] [MainThread]:   schema: public
[0m11:56:58.584780 [info ] [MainThread]:   connect_timeout: 10
[0m11:56:58.585112 [info ] [MainThread]:   role: None
[0m11:56:58.585481 [info ] [MainThread]:   search_path: None
[0m11:56:58.585819 [info ] [MainThread]:   keepalives_idle: 0
[0m11:56:58.586299 [info ] [MainThread]:   sslmode: None
[0m11:56:58.586625 [info ] [MainThread]:   sslcert: None
[0m11:56:58.586939 [info ] [MainThread]:   sslkey: None
[0m11:56:58.587262 [info ] [MainThread]:   sslrootcert: None
[0m11:56:58.587594 [info ] [MainThread]:   application_name: dbt
[0m11:56:58.587909 [info ] [MainThread]:   retries: 1
[0m11:56:58.588345 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m11:56:58.589731 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:56:58.590028 [debug] [MainThread]: Using postgres connection "debug"
[0m11:56:58.590323 [debug] [MainThread]: On debug: select 1 as id
[0m11:56:58.590576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:58.636297 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:56:58.637497 [debug] [MainThread]: On debug: Close
[0m11:56:58.637974 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:56:58.638462 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:56:58.640130 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:56:58.640562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dd96f0>]}
[0m11:56:58.640957 [debug] [MainThread]: Flushing usage events
[0m11:59:46.982265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dab0>]}


============================== 11:59:46.988527 | 54ac246e-dd46-4a22-b438-6ad8e5278e5b ==============================
[0m11:59:46.988527 [info ] [MainThread]: Running with dbt=1.7.7
[0m11:59:46.989289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:47.108306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dba0>]}
[0m11:59:47.168957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8d90>]}
[0m11:59:47.169771 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m11:59:47.176992 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m11:59:47.178024 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:59:47.178433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e8bac0>]}
[0m11:59:48.037664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff813cc70>]}
[0m11:59:48.048042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff832cb20>]}
[0m11:59:48.048643 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:59:48.049091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba2e30>]}
[0m11:59:48.050894 [info ] [MainThread]: 
[0m11:59:48.051727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:59:48.053314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m11:59:48.061633 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m11:59:48.062108 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m11:59:48.062562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:48.101025 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:59:48.102646 [debug] [ThreadPool]: On list_analytics: Close
[0m11:59:48.105149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m11:59:48.109575 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:59:48.110006 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m11:59:48.110356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:48.116053 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:59:48.116515 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m11:59:48.116979 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:59:48.119080 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:59:48.120204 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m11:59:48.120713 [debug] [ThreadPool]: On list_analytics_public: Close
[0m11:59:48.124682 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:48.125140 [debug] [MainThread]: On master: BEGIN
[0m11:59:48.125517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:48.131576 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:48.132294 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:48.132854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:59:48.135706 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:59:48.137087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8405cf0>]}
[0m11:59:48.137702 [debug] [MainThread]: On master: ROLLBACK
[0m11:59:48.138325 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:48.138749 [debug] [MainThread]: On master: BEGIN
[0m11:59:48.139421 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:48.139819 [debug] [MainThread]: On master: COMMIT
[0m11:59:48.140265 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:48.140649 [debug] [MainThread]: On master: COMMIT
[0m11:59:48.141182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:48.141533 [debug] [MainThread]: On master: Close
[0m11:59:48.142243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:59:48.142937 [info ] [MainThread]: 
[0m11:59:48.152206 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m11:59:48.153043 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m11:59:48.153761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m11:59:48.154311 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m11:59:48.154860 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 11:59:48.154645 => 11:59:48.154647
[0m11:59:48.155292 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m11:59:48.178832 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m11:59:48.179395 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m11:59:48.179886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:48.185245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:48.185700 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m11:59:48.186169 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */

    create table "analytics"."public"."households" ("household_id" integer,"city" text,"meter_id" text,"installation_date" date)
  
[0m11:59:48.189588 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m11:59:48.206994 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m11:59:48.207593 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m11:59:48.209081 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.0 seconds
[0m11:59:48.213294 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m11:59:48.227363 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m11:59:48.228059 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m11:59:48.228530 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m11:59:48.230031 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:48.231216 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 11:59:48.155594 => 11:59:48.231047
[0m11:59:48.231644 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m11:59:48.232450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e89bd0>]}
[0m11:59:48.233452 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 10[0m in 0.08s]
[0m11:59:48.234354 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m11:59:48.234929 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m11:59:48.235483 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m11:59:48.236176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m11:59:48.236618 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m11:59:48.237108 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 11:59:48.236929 => 11:59:48.236931
[0m11:59:48.237514 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m11:59:48.285775 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m11:59:48.286417 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m11:59:48.286863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:48.292384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:48.292918 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m11:59:48.293392 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */

    create table "analytics"."public"."smart_meter_readings" ("meter_id" text,"reading_time" timestamp without time zone,"energy_kwh" float8,"voltage" float8,"current" float8)
  
[0m11:59:48.296005 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m11:59:49.409664 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m11:59:49.410354 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m11:59:49.422503 [debug] [Thread-1 (]: SQL status: INSERT 0 1440 in 0.0 seconds
[0m11:59:49.423423 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m11:59:49.425591 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m11:59:49.426051 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m11:59:49.426479 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m11:59:49.427435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:49.428231 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 11:59:48.237889 => 11:59:49.428071
[0m11:59:49.428698 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m11:59:49.429520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff81b3d00>]}
[0m11:59:49.430231 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1440[0m in 1.19s]
[0m11:59:49.430890 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m11:59:49.431374 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m11:59:49.431919 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m11:59:49.432550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m11:59:49.432959 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m11:59:49.433454 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 11:59:49.433258 => 11:59:49.433260
[0m11:59:49.433868 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m11:59:49.437610 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m11:59:49.438051 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m11:59:49.438416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:49.443627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:49.444092 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m11:59:49.444520 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */

    create table "analytics"."public"."tariff_rates" ("rate_id" integer,"start_date" date,"end_date" date,"price_per_kwh" float8)
  
[0m11:59:49.445527 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m11:59:49.448447 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m11:59:49.449280 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m11:59:49.450328 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m11:59:49.451190 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m11:59:49.453228 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m11:59:49.453645 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m11:59:49.454046 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m11:59:49.454826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:49.455671 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 11:59:49.434156 => 11:59:49.455532
[0m11:59:49.456104 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m11:59:49.456841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ac246e-dd46-4a22-b438-6ad8e5278e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff3f62320>]}
[0m11:59:49.457559 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m11:59:49.458144 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m11:59:49.460578 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:49.461049 [debug] [MainThread]: On master: BEGIN
[0m11:59:49.461435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:49.467756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:49.468301 [debug] [MainThread]: On master: COMMIT
[0m11:59:49.468670 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:49.469166 [debug] [MainThread]: On master: COMMIT
[0m11:59:49.469646 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:49.470121 [debug] [MainThread]: On master: Close
[0m11:59:49.470884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:49.471358 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m11:59:49.471981 [info ] [MainThread]: 
[0m11:59:49.472392 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m11:59:49.473328 [debug] [MainThread]: Command end result
[0m11:59:49.481005 [info ] [MainThread]: 
[0m11:59:49.481632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:49.482072 [info ] [MainThread]: 
[0m11:59:49.482604 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:59:49.483856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff813cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff813cf10>]}
[0m11:59:49.484359 [debug] [MainThread]: Flushing usage events
[0m12:04:16.341245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dab0>]}


============================== 12:04:16.348267 | 1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb ==============================
[0m12:04:16.348267 [info ] [MainThread]: Running with dbt=1.7.7
[0m12:04:16.349082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:04:16.470636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dba0>]}
[0m12:04:16.528863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfaa70>]}
[0m12:04:16.529620 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m12:04:16.537263 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m12:04:16.563277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:16.563662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:16.568618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afdd50>]}
[0m12:04:16.579602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca00>]}
[0m12:04:16.579985 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:04:16.580343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcbb0>]}
[0m12:04:16.581818 [info ] [MainThread]: 
[0m12:04:16.582628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:04:16.584495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m12:04:16.592923 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m12:04:16.593327 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:04:16.593657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:16.630093 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:04:16.631620 [debug] [ThreadPool]: On list_analytics: Close
[0m12:04:16.633868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m12:04:16.638130 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:04:16.638479 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m12:04:16.638766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:16.643838 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:04:16.644135 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:04:16.644441 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:04:16.646095 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:04:16.647397 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m12:04:16.647811 [debug] [ThreadPool]: On list_analytics_public: Close
[0m12:04:16.651835 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:16.652168 [debug] [MainThread]: On master: BEGIN
[0m12:04:16.652432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:16.657232 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:16.657551 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:16.657891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:04:16.662265 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:04:16.663096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b32800>]}
[0m12:04:16.663522 [debug] [MainThread]: On master: ROLLBACK
[0m12:04:16.663897 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:16.664152 [debug] [MainThread]: On master: BEGIN
[0m12:04:16.664589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:16.664875 [debug] [MainThread]: On master: COMMIT
[0m12:04:16.665153 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:16.665428 [debug] [MainThread]: On master: COMMIT
[0m12:04:16.665753 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:04:16.666020 [debug] [MainThread]: On master: Close
[0m12:04:16.666583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:04:16.667026 [info ] [MainThread]: 
[0m12:04:16.669273 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m12:04:16.669738 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_households ............................. [RUN]
[0m12:04:16.670445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m12:04:16.670815 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m12:04:16.676209 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m12:04:16.677870 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 12:04:16.671028 => 12:04:16.677692
[0m12:04:16.678168 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m12:04:16.705853 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m12:04:16.707492 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m12:04:16.707805 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m12:04:16.708120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:16.713289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:16.713641 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m12:04:16.713935 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."raw"."households"
  );
  
[0m12:04:16.714720 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.households" does not exist
LINE 18: FROM "analytics"."raw"."households"
              ^

[0m12:04:16.715039 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: ROLLBACK
[0m12:04:16.715541 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 12:04:16.678382 => 12:04:16.715379
[0m12:04:16.715865 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m12:04:16.719838 [debug] [Thread-1 (]: Database Error in model stg_households (models/staging/stg_households.sql)
  relation "raw.households" does not exist
  LINE 18: FROM "analytics"."raw"."households"
                ^
  compiled Code at target/run/energy_analytics/models/staging/stg_households.sql
[0m12:04:16.720269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b401f0>]}
[0m12:04:16.721097 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.stg_households .................... [[31mERROR[0m in 0.05s]
[0m12:04:16.721765 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m12:04:16.722124 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m12:04:16.722595 [info ] [Thread-1 (]: 2 of 3 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m12:04:16.723202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m12:04:16.723538 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m12:04:16.725674 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m12:04:16.726458 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 12:04:16.723730 => 12:04:16.726241
[0m12:04:16.726798 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m12:04:16.730000 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m12:04:16.730799 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m12:04:16.731089 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m12:04:16.731349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:16.736296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:16.736625 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m12:04:16.736884 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."raw"."smart_meter_readings"
  );
  
[0m12:04:16.737327 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.smart_meter_readings" does not exist
LINE 19: FROM "analytics"."raw"."smart_meter_readings"
              ^

[0m12:04:16.737696 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: ROLLBACK
[0m12:04:16.738253 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 12:04:16.727002 => 12:04:16.738079
[0m12:04:16.738599 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m12:04:16.739661 [debug] [Thread-1 (]: Database Error in model stg_smart_meter_readings (models/staging/stg_smart_meter_readings.sql)
  relation "raw.smart_meter_readings" does not exist
  LINE 19: FROM "analytics"."raw"."smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/staging/stg_smart_meter_readings.sql
[0m12:04:16.740020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1100e8e5-2b8f-4e81-89ef-5ed3e350ddbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a3f1f0>]}
[0m12:04:16.740484 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.stg_smart_meter_readings .......... [[31mERROR[0m in 0.02s]
[0m12:04:16.741026 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m12:04:16.742369 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m12:04:16.742694 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.fct_daily_energy ................................... [[33mSKIP[0m]
[0m12:04:16.743088 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m12:04:16.744128 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:16.744407 [debug] [MainThread]: On master: BEGIN
[0m12:04:16.744709 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:16.749874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:16.750199 [debug] [MainThread]: On master: COMMIT
[0m12:04:16.750547 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:16.750822 [debug] [MainThread]: On master: COMMIT
[0m12:04:16.751156 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:04:16.751446 [debug] [MainThread]: On master: Close
[0m12:04:16.752001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:16.752268 [debug] [MainThread]: Connection 'model.energy_analytics.stg_smart_meter_readings' was properly closed.
[0m12:04:16.752786 [info ] [MainThread]: 
[0m12:04:16.753195 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:04:16.753950 [debug] [MainThread]: Command end result
[0m12:04:16.761268 [info ] [MainThread]: 
[0m12:04:16.761754 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:04:16.762066 [info ] [MainThread]: 
[0m12:04:16.762386 [error] [MainThread]:   Database Error in model stg_households (models/staging/stg_households.sql)
  relation "raw.households" does not exist
  LINE 18: FROM "analytics"."raw"."households"
                ^
  compiled Code at target/run/energy_analytics/models/staging/stg_households.sql
[0m12:04:16.762706 [info ] [MainThread]: 
[0m12:04:16.762989 [error] [MainThread]:   Database Error in model stg_smart_meter_readings (models/staging/stg_smart_meter_readings.sql)
  relation "raw.smart_meter_readings" does not exist
  LINE 19: FROM "analytics"."raw"."smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/staging/stg_smart_meter_readings.sql
[0m12:04:16.763291 [info ] [MainThread]: 
[0m12:04:16.763757 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m12:04:16.764716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7162f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a3fc70>]}
[0m12:04:16.765021 [debug] [MainThread]: Flushing usage events
[0m12:07:43.430130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82de10>]}


============================== 12:07:43.439965 | aa2429ff-b5cc-4c8d-a343-d9d07419a296 ==============================
[0m12:07:43.439965 [info ] [MainThread]: Running with dbt=1.7.7
[0m12:07:43.440719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:07:43.556874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bbee0>]}
[0m12:07:43.614438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfc1f0>]}
[0m12:07:43.615084 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m12:07:43.623228 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m12:07:43.651236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:43.652087 [debug] [MainThread]: Partial parsing: updated file: energy_analytics://models/schema.yml
[0m12:07:43.966959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff824d6c0>]}
[0m12:07:43.976748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca30>]}
[0m12:07:43.977156 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:07:43.977509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcb80>]}
[0m12:07:43.978904 [info ] [MainThread]: 
[0m12:07:43.979612 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:43.981013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m12:07:43.989376 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m12:07:43.989725 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:07:43.989943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:44.028542 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:07:44.030048 [debug] [ThreadPool]: On list_analytics: Close
[0m12:07:44.032224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m12:07:44.036193 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:07:44.036513 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m12:07:44.036795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:44.042077 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:07:44.042381 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:07:44.042691 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:07:44.044459 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:07:44.045368 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m12:07:44.045749 [debug] [ThreadPool]: On list_analytics_public: Close
[0m12:07:44.049191 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:44.049527 [debug] [MainThread]: On master: BEGIN
[0m12:07:44.049801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:44.054297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:07:44.054561 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:44.054929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:44.056431 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:07:44.057216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8252770>]}
[0m12:07:44.057565 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:44.057895 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:44.058117 [debug] [MainThread]: On master: BEGIN
[0m12:07:44.058492 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:07:44.058753 [debug] [MainThread]: On master: COMMIT
[0m12:07:44.059006 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:44.059239 [debug] [MainThread]: On master: COMMIT
[0m12:07:44.059543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:07:44.059802 [debug] [MainThread]: On master: Close
[0m12:07:44.060334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:44.060762 [info ] [MainThread]: 
[0m12:07:44.066125 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m12:07:44.066544 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m12:07:44.067225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m12:07:44.067522 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m12:07:44.067951 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 12:07:44.067738 => 12:07:44.067740
[0m12:07:44.068242 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m12:07:44.090594 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m12:07:44.091093 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m12:07:44.091430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:44.097012 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:07:44.097352 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m12:07:44.097675 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */

    create table "analytics"."public"."households" ("household_id" integer,"city" text,"meter_id" text,"installation_date" date)
  
[0m12:07:44.099826 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m12:07:44.116748 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m12:07:44.117117 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m12:07:44.118334 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.0 seconds
[0m12:07:44.122353 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m12:07:44.134602 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m12:07:44.135059 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m12:07:44.135439 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m12:07:44.136095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:07:44.137036 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 12:07:44.068441 => 12:07:44.136881
[0m12:07:44.137331 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m12:07:44.137976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff82708b0>]}
[0m12:07:44.138773 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 10[0m in 0.07s]
[0m12:07:44.139483 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m12:07:44.139871 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m12:07:44.140290 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m12:07:44.140903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m12:07:44.141186 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m12:07:44.141479 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 12:07:44.141343 => 12:07:44.141345
[0m12:07:44.141726 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m12:07:44.189106 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m12:07:44.189508 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m12:07:44.189849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:44.195119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:07:44.195435 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m12:07:44.195740 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */

    create table "analytics"."public"."smart_meter_readings" ("meter_id" text,"reading_time" timestamp without time zone,"energy_kwh" float8,"voltage" float8,"current" float8)
  
[0m12:07:44.198708 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m12:07:45.261724 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m12:07:45.262269 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m12:07:45.274296 [debug] [Thread-1 (]: SQL status: INSERT 0 1440 in 0.0 seconds
[0m12:07:45.275029 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m12:07:45.278646 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m12:07:45.278982 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m12:07:45.279304 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m12:07:45.280017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:07:45.280707 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 12:07:44.141901 => 12:07:45.280537
[0m12:07:45.281001 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m12:07:45.281584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af2830>]}
[0m12:07:45.282025 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1440[0m in 1.14s]
[0m12:07:45.282688 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m12:07:45.283145 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m12:07:45.283550 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m12:07:45.284239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m12:07:45.284574 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m12:07:45.284982 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 12:07:45.284777 => 12:07:45.284779
[0m12:07:45.285283 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m12:07:45.288486 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m12:07:45.288870 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m12:07:45.289283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:45.298512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:07:45.298850 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m12:07:45.299129 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */

    create table "analytics"."public"."tariff_rates" ("rate_id" integer,"start_date" date,"end_date" date,"price_per_kwh" float8)
  
[0m12:07:45.300009 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m12:07:45.302345 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m12:07:45.302665 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m12:07:45.303191 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m12:07:45.303799 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m12:07:45.305796 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m12:07:45.306076 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m12:07:45.306348 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m12:07:45.306870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:07:45.307502 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 12:07:45.285465 => 12:07:45.307363
[0m12:07:45.307781 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m12:07:45.308432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2429ff-b5cc-4c8d-a343-d9d07419a296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff810f9a0>]}
[0m12:07:45.308874 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m12:07:45.309434 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m12:07:45.311150 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.311386 [debug] [MainThread]: On master: BEGIN
[0m12:07:45.311581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:45.316697 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:07:45.317039 [debug] [MainThread]: On master: COMMIT
[0m12:07:45.317288 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.317529 [debug] [MainThread]: On master: COMMIT
[0m12:07:45.317842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:07:45.318112 [debug] [MainThread]: On master: Close
[0m12:07:45.318611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:45.318881 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m12:07:45.319335 [info ] [MainThread]: 
[0m12:07:45.319753 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m12:07:45.320558 [debug] [MainThread]: Command end result
[0m12:07:45.326855 [info ] [MainThread]: 
[0m12:07:45.327336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:45.327752 [info ] [MainThread]: 
[0m12:07:45.328226 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:07:45.329476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dde380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af2830>]}
[0m12:07:45.329892 [debug] [MainThread]: Flushing usage events
[0m12:07:56.211154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 12:07:56.217157 | 3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1 ==============================
[0m12:07:56.217157 [info ] [MainThread]: Running with dbt=1.7.7
[0m12:07:56.217947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:56.331289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m12:07:56.388520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8e80>]}
[0m12:07:56.389119 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m12:07:56.396259 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m12:07:56.420721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:56.421070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:56.425748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af5de0>]}
[0m12:07:56.433983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8a90>]}
[0m12:07:56.434334 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:07:56.434692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8c40>]}
[0m12:07:56.436148 [info ] [MainThread]: 
[0m12:07:56.436954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:56.438770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m12:07:56.447084 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m12:07:56.447422 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:07:56.447712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:56.483238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:07:56.484586 [debug] [ThreadPool]: On list_analytics: Close
[0m12:07:56.486774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m12:07:56.491179 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:07:56.491497 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m12:07:56.491818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:56.496862 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:07:56.497138 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m12:07:56.497421 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:07:56.498751 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:07:56.499968 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m12:07:56.500331 [debug] [ThreadPool]: On list_analytics_public: Close
[0m12:07:56.504234 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:56.504541 [debug] [MainThread]: On master: BEGIN
[0m12:07:56.504798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:56.509689 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:07:56.509953 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:56.510277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:56.513607 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:07:56.514381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b32830>]}
[0m12:07:56.514767 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:56.515102 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:56.515350 [debug] [MainThread]: On master: BEGIN
[0m12:07:56.515784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:07:56.516043 [debug] [MainThread]: On master: COMMIT
[0m12:07:56.516288 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:56.516532 [debug] [MainThread]: On master: COMMIT
[0m12:07:56.516870 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:07:56.517112 [debug] [MainThread]: On master: Close
[0m12:07:56.517655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:56.518012 [info ] [MainThread]: 
[0m12:07:56.520143 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m12:07:56.520558 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_households ............................. [RUN]
[0m12:07:56.521175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m12:07:56.521477 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m12:07:56.526778 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m12:07:56.528576 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 12:07:56.521678 => 12:07:56.528402
[0m12:07:56.528909 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m12:07:56.555638 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m12:07:56.556565 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m12:07:56.556889 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m12:07:56.557177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:56.562197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:07:56.562479 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m12:07:56.562742 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m12:07:56.564822 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m12:07:56.569535 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m12:07:56.569950 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m12:07:56.570409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:07:56.582165 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m12:07:56.582513 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m12:07:56.582869 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m12:07:56.583664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:07:56.588424 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m12:07:56.591532 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m12:07:56.591871 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m12:07:56.592269 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:07:56.593324 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 12:07:56.529098 => 12:07:56.593178
[0m12:07:56.593612 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m12:07:56.594231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b67790>]}
[0m12:07:56.595089 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_households ........................ [[32mSELECT 10[0m in 0.07s]
[0m12:07:56.595869 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m12:07:56.596288 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m12:07:56.596710 [info ] [Thread-1 (]: 2 of 3 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m12:07:56.597313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m12:07:56.597623 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m12:07:56.599655 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m12:07:56.600470 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 12:07:56.597838 => 12:07:56.600302
[0m12:07:56.600770 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m12:07:56.603741 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m12:07:56.604455 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m12:07:56.604718 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m12:07:56.604991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:56.609839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:07:56.610184 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m12:07:56.610479 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m12:07:56.612586 [debug] [Thread-1 (]: SQL status: SELECT 1440 in 0.0 seconds
[0m12:07:56.614973 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m12:07:56.615302 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m12:07:56.615706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:07:56.617173 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m12:07:56.617485 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m12:07:56.617808 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m12:07:56.618552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:07:56.620398 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m12:07:56.620976 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m12:07:56.621244 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m12:07:56.621587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:07:56.622558 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 12:07:56.600986 => 12:07:56.622422
[0m12:07:56.622834 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m12:07:56.623427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9adbbb0>]}
[0m12:07:56.623899 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1440[0m in 0.03s]
[0m12:07:56.624522 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m12:07:56.625920 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m12:07:56.626274 [info ] [Thread-1 (]: 3 of 3 START sql table model public.fct_daily_energy ........................... [RUN]
[0m12:07:56.626923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m12:07:56.627210 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m12:07:56.629571 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m12:07:56.630483 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 12:07:56.627409 => 12:07:56.630289
[0m12:07:56.630776 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m12:07:56.633828 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m12:07:56.634580 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m12:07:56.634922 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m12:07:56.635182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:56.639942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:07:56.640242 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m12:07:56.640510 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m12:07:56.643366 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0.0 seconds
[0m12:07:56.645727 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m12:07:56.646045 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m12:07:56.646438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:07:56.648409 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m12:07:56.648685 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m12:07:56.648935 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m12:07:56.649426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:07:56.672108 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m12:07:56.672962 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m12:07:56.673333 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m12:07:56.673845 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:07:56.674925 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 12:07:56.630976 => 12:07:56.674782
[0m12:07:56.675236 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m12:07:56.675894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d8c3969-a9ef-4cfc-b291-d60e04bb3cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a1e200>]}
[0m12:07:56.676439 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 60[0m in 0.05s]
[0m12:07:56.677131 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m12:07:56.678199 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:56.678474 [debug] [MainThread]: On master: BEGIN
[0m12:07:56.678722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:56.683571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:07:56.683920 [debug] [MainThread]: On master: COMMIT
[0m12:07:56.684188 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:56.684455 [debug] [MainThread]: On master: COMMIT
[0m12:07:56.684781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:07:56.685025 [debug] [MainThread]: On master: Close
[0m12:07:56.685525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:56.685853 [debug] [MainThread]: Connection 'model.energy_analytics.fct_daily_energy' was properly closed.
[0m12:07:56.686312 [info ] [MainThread]: 
[0m12:07:56.686747 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m12:07:56.687563 [debug] [MainThread]: Command end result
[0m12:07:56.693638 [info ] [MainThread]: 
[0m12:07:56.694061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:56.694389 [info ] [MainThread]: 
[0m12:07:56.694867 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:07:56.695832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a1eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a1f370>]}
[0m12:07:56.696184 [debug] [MainThread]: Flushing usage events
[0m13:30:54.928100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75da80>]}


============================== 13:30:54.935921 | 41c64bf1-3a18-4740-a5ea-2e2969755dea ==============================
[0m13:30:54.935921 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:30:54.936738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:30:55.057428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db70>]}
[0m13:30:55.115468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8220>]}
[0m13:30:55.116194 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:30:55.124896 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:30:55.152584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:30:55.153117 [debug] [MainThread]: Partial parsing: updated file: energy_analytics://data/households.csv
[0m13:30:55.234735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fc0d0>]}
[0m13:30:55.245796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8a30>]}
[0m13:30:55.246250 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:30:55.246729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8be0>]}
[0m13:30:55.248281 [info ] [MainThread]: 
[0m13:30:55.249074 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:55.251005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:30:55.259757 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:30:55.260172 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:30:55.260486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:55.298367 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:30:55.299811 [debug] [ThreadPool]: On list_analytics: Close
[0m13:30:55.302031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:30:55.306127 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:30:55.306473 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:30:55.306762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:55.312295 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:55.312595 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:30:55.312886 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:30:55.314776 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:30:55.315849 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:30:55.316212 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:30:55.320625 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:55.320957 [debug] [MainThread]: On master: BEGIN
[0m13:30:55.321201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:55.325994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:55.326282 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:55.326655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:55.331246 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:55.332022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca7b50>]}
[0m13:30:55.332397 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:55.332752 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:55.333021 [debug] [MainThread]: On master: BEGIN
[0m13:30:55.333445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:55.333706 [debug] [MainThread]: On master: COMMIT
[0m13:30:55.333960 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:55.334216 [debug] [MainThread]: On master: COMMIT
[0m13:30:55.334562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:55.334819 [debug] [MainThread]: On master: Close
[0m13:30:55.335351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:55.335826 [info ] [MainThread]: 
[0m13:30:55.338039 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m13:30:55.338500 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_households ............................. [RUN]
[0m13:30:55.339123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m13:30:55.339455 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m13:30:55.344841 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m13:30:55.346789 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 13:30:55.339660 => 13:30:55.346632
[0m13:30:55.347078 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m13:30:55.374343 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m13:30:55.375674 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:30:55.375962 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m13:30:55.376280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:55.381656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:55.381964 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:30:55.382231 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m13:30:55.385592 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m13:30:55.411391 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:30:55.411860 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households" rename to "stg_households__dbt_backup"
[0m13:30:55.412537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:55.414684 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:30:55.415007 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m13:30:55.415431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:55.428373 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:30:55.428706 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:30:55.429010 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:30:55.429916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:55.434014 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m13:30:55.437024 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:30:55.437339 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m13:30:55.439608 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:55.440671 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 13:30:55.347296 => 13:30:55.440519
[0m13:30:55.440943 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m13:30:55.441607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a87d30>]}
[0m13:30:55.442465 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_households ........................ [[32mSELECT 10[0m in 0.10s]
[0m13:30:55.443174 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m13:30:55.443610 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m13:30:55.444022 [info ] [Thread-1 (]: 2 of 3 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m13:30:55.444609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m13:30:55.444888 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m13:30:55.446919 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.447779 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 13:30:55.445066 => 13:30:55.447600
[0m13:30:55.448056 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m13:30:55.451258 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.452011 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.452351 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m13:30:55.452692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:55.458093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:55.458444 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.458802 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m13:30:55.462055 [debug] [Thread-1 (]: SQL status: SELECT 1440 in 0.0 seconds
[0m13:30:55.464544 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.464859 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings" rename to "stg_smart_meter_readings__dbt_backup"
[0m13:30:55.465287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:55.467951 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.468261 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m13:30:55.468696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:55.470125 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:30:55.470418 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.470715 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:30:55.471646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:55.473589 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m13:30:55.474167 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:30:55.474438 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m13:30:55.475859 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:55.476841 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 13:30:55.448243 => 13:30:55.476696
[0m13:30:55.477111 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m13:30:55.477723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a92380>]}
[0m13:30:55.478190 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1440[0m in 0.03s]
[0m13:30:55.478796 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m13:30:55.480132 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m13:30:55.480499 [info ] [Thread-1 (]: 3 of 3 START sql table model public.fct_daily_energy ........................... [RUN]
[0m13:30:55.481091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m13:30:55.481458 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m13:30:55.483737 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m13:30:55.484884 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 13:30:55.481664 => 13:30:55.484701
[0m13:30:55.485178 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m13:30:55.488162 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m13:30:55.488922 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:30:55.489191 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m13:30:55.489444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:55.494453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:55.494763 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:30:55.495041 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m13:30:55.497810 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0.0 seconds
[0m13:30:55.500306 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:30:55.500601 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy" rename to "fct_daily_energy__dbt_backup"
[0m13:30:55.501128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:55.503140 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:30:55.503412 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m13:30:55.503766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:55.505284 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:30:55.505586 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:30:55.505837 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:30:55.506555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:55.508406 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m13:30:55.508992 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:30:55.509274 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m13:30:55.510507 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:55.511459 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 13:30:55.485373 => 13:30:55.511317
[0m13:30:55.511732 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m13:30:55.512351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41c64bf1-3a18-4740-a5ea-2e2969755dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aee590>]}
[0m13:30:55.512814 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 60[0m in 0.03s]
[0m13:30:55.513405 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m13:30:55.514502 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:55.514742 [debug] [MainThread]: On master: BEGIN
[0m13:30:55.514975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:55.519812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:55.520073 [debug] [MainThread]: On master: COMMIT
[0m13:30:55.520344 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:55.520604 [debug] [MainThread]: On master: COMMIT
[0m13:30:55.520913 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:55.521158 [debug] [MainThread]: On master: Close
[0m13:30:55.521667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:55.521896 [debug] [MainThread]: Connection 'model.energy_analytics.fct_daily_energy' was properly closed.
[0m13:30:55.522347 [info ] [MainThread]: 
[0m13:30:55.522737 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:30:55.523704 [debug] [MainThread]: Command end result
[0m13:30:55.530749 [info ] [MainThread]: 
[0m13:30:55.531234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:55.531599 [info ] [MainThread]: 
[0m13:30:55.532015 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:30:55.533015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98ed6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98eead0>]}
[0m13:30:55.533335 [debug] [MainThread]: Flushing usage events
[0m13:32:36.958460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dab0>]}


============================== 13:32:36.965218 | 0154e005-e77b-463c-80cc-4be44224bc47 ==============================
[0m13:32:36.965218 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:32:36.966023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:37.080976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dba0>]}
[0m13:32:37.140036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfea70>]}
[0m13:32:37.140671 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:32:37.149238 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:32:37.176238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:37.176852 [debug] [MainThread]: Partial parsing: updated file: energy_analytics://data/households.csv
[0m13:32:37.263179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99f80d0>]}
[0m13:32:37.273829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc0a60>]}
[0m13:32:37.274283 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:32:37.274695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc0c10>]}
[0m13:32:37.276169 [info ] [MainThread]: 
[0m13:32:37.276990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:37.278884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:32:37.287274 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:32:37.287647 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:32:37.287957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:37.325905 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:32:37.327306 [debug] [ThreadPool]: On list_analytics: Close
[0m13:32:37.329445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:32:37.333608 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:32:37.333986 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:32:37.334271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:37.339370 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:32:37.339696 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:32:37.340007 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:32:37.341671 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:32:37.342731 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:32:37.343104 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:32:37.347377 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.347712 [debug] [MainThread]: On master: BEGIN
[0m13:32:37.347975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:37.352652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:32:37.352975 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.353303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:37.357942 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:32:37.358796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca7d00>]}
[0m13:32:37.359167 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:37.359484 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.359790 [debug] [MainThread]: On master: BEGIN
[0m13:32:37.360212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:32:37.360456 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.360724 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.360989 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.361304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:32:37.361558 [debug] [MainThread]: On master: Close
[0m13:32:37.362098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:37.362461 [info ] [MainThread]: 
[0m13:32:37.364673 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m13:32:37.365104 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_households ............................. [RUN]
[0m13:32:37.365691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m13:32:37.366079 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m13:32:37.371703 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m13:32:37.373917 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 13:32:37.366292 => 13:32:37.373593
[0m13:32:37.374262 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m13:32:37.402009 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m13:32:37.403084 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:32:37.403420 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m13:32:37.403738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:37.408884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:37.409180 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:32:37.409428 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m13:32:37.412640 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m13:32:37.438908 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:32:37.439375 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households" rename to "stg_households__dbt_backup"
[0m13:32:37.440018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:37.442373 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:32:37.442709 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m13:32:37.443149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:37.456526 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:32:37.456876 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:32:37.457171 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:32:37.458090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:32:37.462463 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m13:32:37.465553 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:32:37.465893 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m13:32:37.467309 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:32:37.468363 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 13:32:37.374466 => 13:32:37.468222
[0m13:32:37.468637 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m13:32:37.469230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a83d60>]}
[0m13:32:37.470085 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_households ........................ [[32mSELECT 10[0m in 0.10s]
[0m13:32:37.470793 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m13:32:37.471181 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m13:32:37.471585 [info ] [Thread-1 (]: 2 of 3 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m13:32:37.472191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m13:32:37.472487 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m13:32:37.474510 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.475295 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 13:32:37.472655 => 13:32:37.475120
[0m13:32:37.475565 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m13:32:37.478824 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.479400 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.479673 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m13:32:37.479932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:37.485054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:37.485374 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.485637 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m13:32:37.488955 [debug] [Thread-1 (]: SQL status: SELECT 1440 in 0.0 seconds
[0m13:32:37.491433 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.491774 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings" rename to "stg_smart_meter_readings__dbt_backup"
[0m13:32:37.492230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:37.494989 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.495261 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m13:32:37.495621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:37.497044 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:32:37.497303 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.497531 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:32:37.498347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:32:37.500227 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m13:32:37.500808 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:32:37.501069 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m13:32:37.502206 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:32:37.503217 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 13:32:37.475748 => 13:32:37.503078
[0m13:32:37.503484 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m13:32:37.504198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a8dab0>]}
[0m13:32:37.504721 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1440[0m in 0.03s]
[0m13:32:37.505286 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m13:32:37.506639 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m13:32:37.507025 [info ] [Thread-1 (]: 3 of 3 START sql table model public.fct_daily_energy ........................... [RUN]
[0m13:32:37.507632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m13:32:37.507957 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m13:32:37.510162 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m13:32:37.511164 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 13:32:37.508129 => 13:32:37.510993
[0m13:32:37.511425 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m13:32:37.514530 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m13:32:37.515138 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:32:37.515392 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m13:32:37.515681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:37.520583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:37.520985 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:32:37.521313 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m13:32:37.524175 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0.0 seconds
[0m13:32:37.526642 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:32:37.526934 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy" rename to "fct_daily_energy__dbt_backup"
[0m13:32:37.527396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:37.529476 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:32:37.529801 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m13:32:37.530173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:37.531670 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:32:37.531944 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:32:37.532234 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:32:37.532858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:32:37.534783 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m13:32:37.535417 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:32:37.535705 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m13:32:37.536674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:32:37.537644 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 13:32:37.511609 => 13:32:37.537509
[0m13:32:37.537971 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m13:32:37.538610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0154e005-e77b-463c-80cc-4be44224bc47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af2440>]}
[0m13:32:37.539119 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 60[0m in 0.03s]
[0m13:32:37.539653 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m13:32:37.540711 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.540961 [debug] [MainThread]: On master: BEGIN
[0m13:32:37.541157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:37.545860 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:32:37.546115 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.546308 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.546550 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.546883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:32:37.547123 [debug] [MainThread]: On master: Close
[0m13:32:37.547596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:37.547828 [debug] [MainThread]: Connection 'model.energy_analytics.fct_daily_energy' was properly closed.
[0m13:32:37.548250 [info ] [MainThread]: 
[0m13:32:37.548689 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:32:37.549466 [debug] [MainThread]: Command end result
[0m13:32:37.556422 [info ] [MainThread]: 
[0m13:32:37.556847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:37.557179 [info ] [MainThread]: 
[0m13:32:37.557609 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:32:37.558578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc2a25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff98efbe0>]}
[0m13:32:37.558930 [debug] [MainThread]: Flushing usage events
[0m13:33:13.691740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>]}


============================== 13:33:13.698306 | c662f4fc-e6da-4ffe-aa2a-9f01ee3fa6b0 ==============================
[0m13:33:13.698306 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:33:13.699149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:33:13.816407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c662f4fc-e6da-4ffe-aa2a-9f01ee3fa6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dc00>]}
[0m13:33:13.874264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c662f4fc-e6da-4ffe-aa2a-9f01ee3fa6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8d30>]}
[0m13:33:13.874885 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:33:13.882325 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:33:13.909063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:13.909401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:13.914186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c662f4fc-e6da-4ffe-aa2a-9f01ee3fa6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af5e10>]}
[0m13:33:13.923358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c662f4fc-e6da-4ffe-aa2a-9f01ee3fa6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcaf0>]}
[0m13:33:13.923717 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:33:13.924148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c662f4fc-e6da-4ffe-aa2a-9f01ee3fa6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcc40>]}
[0m13:33:13.925724 [info ] [MainThread]: 
[0m13:33:13.926484 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:13.928641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:33:13.937125 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:13.937470 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:33:13.937689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:13.974315 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:33:13.974717 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:13.975010 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:33:13.977304 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:33:13.978730 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:33:13.979176 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:33:13.984523 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:13.984954 [debug] [MainThread]: On master: BEGIN
[0m13:33:13.985393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:13.990822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:13.991213 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:13.991564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:13.996442 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:33:13.997338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c662f4fc-e6da-4ffe-aa2a-9f01ee3fa6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cabc10>]}
[0m13:33:13.997713 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:13.998058 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:13.998361 [debug] [MainThread]: On master: BEGIN
[0m13:33:13.998787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:13.999108 [debug] [MainThread]: On master: COMMIT
[0m13:33:13.999385 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:13.999641 [debug] [MainThread]: On master: COMMIT
[0m13:33:13.999980 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:14.000253 [debug] [MainThread]: On master: Close
[0m13:33:14.000915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:14.001314 [info ] [MainThread]: 
[0m13:33:14.003919 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:14.004327 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m13:33:14.005082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m13:33:14.005451 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:14.016865 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:14.018070 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 13:33:14.005657 => 13:33:14.017905
[0m13:33:14.018385 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:14.028676 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:14.029929 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:14.030320 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m13:33:14.030611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:14.035715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:14.036118 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:14.036421 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m13:33:14.037172 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:14.038772 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 13:33:14.018605 => 13:33:14.038600
[0m13:33:14.039094 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m13:33:14.039427 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m13:33:14.040552 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_households_household_id ............................... [[32mPASS[0m in 0.04s]
[0m13:33:14.041347 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:14.041774 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:14.042222 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m13:33:14.042904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m13:33:14.043286 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:14.046500 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:14.047324 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 13:33:14.043494 => 13:33:14.047105
[0m13:33:14.047621 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:14.049349 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:14.050018 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:14.050329 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m13:33:14.050623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:14.055861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:14.056203 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:14.056536 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m13:33:14.057195 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:14.058368 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 13:33:14.047793 => 13:33:14.058156
[0m13:33:14.058778 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m13:33:14.059211 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m13:33:14.059890 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_households_meter_id ................................... [[32mPASS[0m in 0.02s]
[0m13:33:14.060503 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:14.060865 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:14.061264 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m13:33:14.061953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m13:33:14.062292 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:14.065507 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:14.066548 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 13:33:14.062489 => 13:33:14.066373
[0m13:33:14.066864 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:14.068581 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:14.069168 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:14.069461 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m13:33:14.069737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:14.075052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:14.075356 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:14.075615 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m13:33:14.076270 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:14.077395 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 13:33:14.067076 => 13:33:14.077231
[0m13:33:14.077767 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m13:33:14.078184 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m13:33:14.078884 [info ] [Thread-1 (]: 3 of 5 PASS not_null_stg_smart_meter_readings_meter_id ......................... [[32mPASS[0m in 0.02s]
[0m13:33:14.079569 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:14.079938 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:14.080366 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m13:33:14.081052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m13:33:14.081403 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:14.085326 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:14.086165 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 13:33:14.081613 => 13:33:14.085966
[0m13:33:14.086463 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:14.088131 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:14.088701 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:14.088966 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m13:33:14.089243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:14.094300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:14.094623 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:14.094915 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m13:33:14.095561 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:14.096680 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 13:33:14.086671 => 13:33:14.096505
[0m13:33:14.097052 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m13:33:14.097445 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m13:33:14.098150 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_smart_meter_readings_reading_time ..................... [[32mPASS[0m in 0.02s]
[0m13:33:14.098671 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:14.099106 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:14.099529 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m13:33:14.100196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m13:33:14.100488 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:14.105321 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:14.106161 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 13:33:14.100663 => 13:33:14.105944
[0m13:33:14.106448 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:14.108151 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:14.108742 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:14.109087 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m13:33:14.109372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:14.114452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:14.114759 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:14.115111 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:14.116082 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:14.117344 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 13:33:14.106650 => 13:33:14.117158
[0m13:33:14.117753 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m13:33:14.118208 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m13:33:14.118959 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_households_household_id ................................. [[32mPASS[0m in 0.02s]
[0m13:33:14.119602 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:14.121428 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:14.121670 [debug] [MainThread]: On master: BEGIN
[0m13:33:14.121884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:14.126627 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:14.126938 [debug] [MainThread]: On master: COMMIT
[0m13:33:14.127220 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:14.127478 [debug] [MainThread]: On master: COMMIT
[0m13:33:14.127833 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:14.128171 [debug] [MainThread]: On master: Close
[0m13:33:14.128699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:14.129041 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m13:33:14.129513 [info ] [MainThread]: 
[0m13:33:14.129979 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:33:14.130986 [debug] [MainThread]: Command end result
[0m13:33:14.137466 [info ] [MainThread]: 
[0m13:33:14.137968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:14.138378 [info ] [MainThread]: 
[0m13:33:14.138788 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:33:14.139739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6cfd0>]}
[0m13:33:14.140040 [debug] [MainThread]: Flushing usage events
[0m13:33:38.058538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 13:33:38.064645 | 67ec2f63-3024-47dd-9d6a-1c2ae77b22ae ==============================
[0m13:33:38.064645 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:33:38.065430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:33:38.181353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m13:33:38.239424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfe9b0>]}
[0m13:33:38.240040 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:33:38.247212 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:33:38.272867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:38.273264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:38.277983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af9de0>]}
[0m13:33:38.287717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8a90>]}
[0m13:33:38.288117 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:33:38.288519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8c40>]}
[0m13:33:38.289997 [info ] [MainThread]: 
[0m13:33:38.290739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:38.292695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:33:38.301021 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:33:38.301377 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:33:38.301611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:38.335568 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:33:38.336939 [debug] [ThreadPool]: On list_analytics: Close
[0m13:33:38.339043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:33:38.343201 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:38.343483 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:33:38.343762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:38.349032 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:33:38.349327 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:38.349749 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:33:38.351496 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:33:38.352868 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:33:38.353241 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:33:38.357862 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:38.358169 [debug] [MainThread]: On master: BEGIN
[0m13:33:38.358394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:38.363035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:38.363305 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:38.363654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:38.368388 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:33:38.369224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b32a40>]}
[0m13:33:38.369586 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:38.369901 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:38.370188 [debug] [MainThread]: On master: BEGIN
[0m13:33:38.370594 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:38.370838 [debug] [MainThread]: On master: COMMIT
[0m13:33:38.371106 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:38.371346 [debug] [MainThread]: On master: COMMIT
[0m13:33:38.371656 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:38.371905 [debug] [MainThread]: On master: Close
[0m13:33:38.372508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:38.372944 [info ] [MainThread]: 
[0m13:33:38.375183 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m13:33:38.375623 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m13:33:38.376292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m13:33:38.376659 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m13:33:38.377106 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 13:33:38.376885 => 13:33:38.376888
[0m13:33:38.377433 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m13:33:38.399782 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:33:38.400202 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m13:33:38.400539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:38.408939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:38.409395 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:33:38.409722 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */
truncate table "analytics"."public"."households"
[0m13:33:38.411963 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:33:38.429520 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:33:38.429894 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:33:38.431546 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m13:33:38.435645 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m13:33:38.445998 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:33:38.446311 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:33:38.446562 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:33:38.447662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:33:38.448498 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 13:33:38.377633 => 13:33:38.448338
[0m13:33:38.448818 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m13:33:38.449485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b980d0>]}
[0m13:33:38.450321 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 11[0m in 0.07s]
[0m13:33:38.451024 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m13:33:38.451467 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m13:33:38.451881 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m13:33:38.452524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m13:33:38.452807 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m13:33:38.453199 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 13:33:38.453019 => 13:33:38.453020
[0m13:33:38.453486 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m13:33:38.497125 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:33:38.497470 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m13:33:38.497770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:38.502959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:38.503289 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:33:38.503587 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */
truncate table "analytics"."public"."smart_meter_readings"
[0m13:33:38.506233 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:33:39.583262 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:33:39.583801 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m13:33:39.598978 [debug] [Thread-1 (]: SQL status: INSERT 0 1440 in 0.0 seconds
[0m13:33:39.599905 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m13:33:39.603494 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:33:39.603824 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:33:39.604134 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:33:39.605384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:33:39.606110 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 13:33:38.453651 => 13:33:39.605952
[0m13:33:39.606402 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m13:33:39.607037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8550>]}
[0m13:33:39.607536 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1440[0m in 1.15s]
[0m13:33:39.608287 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m13:33:39.608718 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m13:33:39.609164 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m13:33:39.609783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m13:33:39.610119 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m13:33:39.610461 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 13:33:39.610309 => 13:33:39.610310
[0m13:33:39.610707 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m13:33:39.615249 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:33:39.615603 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m13:33:39.615894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:39.621928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:39.622307 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:33:39.622616 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */
truncate table "analytics"."public"."tariff_rates"
[0m13:33:39.623285 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:33:39.625752 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:33:39.626065 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:33:39.626660 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m13:33:39.627307 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m13:33:39.629087 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:33:39.629378 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:33:39.629687 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:33:39.630385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:33:39.631027 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 13:33:39.610860 => 13:33:39.630880
[0m13:33:39.631348 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m13:33:39.632041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ec2f63-3024-47dd-9d6a-1c2ae77b22ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca64d0>]}
[0m13:33:39.632579 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m13:33:39.633198 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m13:33:39.634892 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:39.635178 [debug] [MainThread]: On master: BEGIN
[0m13:33:39.635438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:39.641133 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:39.641484 [debug] [MainThread]: On master: COMMIT
[0m13:33:39.641749 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:39.642046 [debug] [MainThread]: On master: COMMIT
[0m13:33:39.642432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:39.642688 [debug] [MainThread]: On master: Close
[0m13:33:39.643279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:39.643586 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m13:33:39.644093 [info ] [MainThread]: 
[0m13:33:39.644517 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m13:33:39.645396 [debug] [MainThread]: Command end result
[0m13:33:39.651486 [info ] [MainThread]: 
[0m13:33:39.651873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:39.652237 [info ] [MainThread]: 
[0m13:33:39.652669 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:33:39.653645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfe9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb712320>]}
[0m13:33:39.653962 [debug] [MainThread]: Flushing usage events
[0m13:33:45.352746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75da80>]}


============================== 13:33:45.359079 | df57c250-fd91-4560-b835-6ef3f63ec9fe ==============================
[0m13:33:45.359079 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:33:45.359866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:45.475974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db70>]}
[0m13:33:45.533558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cff2b0>]}
[0m13:33:45.534250 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:33:45.541389 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:33:45.566405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:45.566800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:45.571730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af5d80>]}
[0m13:33:45.581003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca30>]}
[0m13:33:45.581407 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:33:45.581795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcbe0>]}
[0m13:33:45.583216 [info ] [MainThread]: 
[0m13:33:45.584142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:45.586117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:33:45.594678 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:33:45.595186 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:33:45.595487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:45.631292 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:33:45.632714 [debug] [ThreadPool]: On list_analytics: Close
[0m13:33:45.634881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:33:45.639125 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:45.639434 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:33:45.639710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:45.645877 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:33:45.646239 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:45.646528 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:33:45.648878 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:33:45.650293 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:33:45.650655 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:33:45.655232 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:45.655551 [debug] [MainThread]: On master: BEGIN
[0m13:33:45.655810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:45.661704 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:45.662048 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:45.662401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:45.666832 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:33:45.667713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b327d0>]}
[0m13:33:45.668116 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:45.668446 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:45.668760 [debug] [MainThread]: On master: BEGIN
[0m13:33:45.669424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:45.669881 [debug] [MainThread]: On master: COMMIT
[0m13:33:45.670330 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:45.670727 [debug] [MainThread]: On master: COMMIT
[0m13:33:45.671243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:45.671635 [debug] [MainThread]: On master: Close
[0m13:33:45.672478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:45.672984 [info ] [MainThread]: 
[0m13:33:45.676712 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m13:33:45.677267 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_households ............................. [RUN]
[0m13:33:45.678002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m13:33:45.678431 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m13:33:45.684423 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m13:33:45.685646 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 13:33:45.678642 => 13:33:45.685462
[0m13:33:45.685996 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m13:33:45.713240 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m13:33:45.714123 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:33:45.714422 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m13:33:45.714720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:45.721988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:45.722307 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:33:45.722589 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m13:33:45.725356 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:33:45.730444 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:33:45.730761 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households" rename to "stg_households__dbt_backup"
[0m13:33:45.731234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:45.733358 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:33:45.733651 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m13:33:45.734039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:45.748159 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:33:45.748505 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:33:45.748848 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:33:45.749491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:33:45.753693 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m13:33:45.756571 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:33:45.756866 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m13:33:45.757980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:45.759016 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 13:33:45.686238 => 13:33:45.758846
[0m13:33:45.759300 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m13:33:45.759984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bbd7b0>]}
[0m13:33:45.761030 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_households ........................ [[32mSELECT 11[0m in 0.08s]
[0m13:33:45.761741 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m13:33:45.762155 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m13:33:45.762601 [info ] [Thread-1 (]: 2 of 3 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m13:33:45.763268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m13:33:45.763589 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m13:33:45.765587 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.766389 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 13:33:45.763775 => 13:33:45.766219
[0m13:33:45.766676 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m13:33:45.769715 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.770486 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.770806 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m13:33:45.771152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:45.776725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:45.777092 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.777519 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m13:33:45.780120 [debug] [Thread-1 (]: SQL status: SELECT 1440 in 0.0 seconds
[0m13:33:45.782651 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.782958 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings" rename to "stg_smart_meter_readings__dbt_backup"
[0m13:33:45.783397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:45.785385 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.785658 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m13:33:45.786060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:45.787514 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:33:45.787778 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.788042 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:33:45.788868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:33:45.790724 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m13:33:45.791344 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:33:45.791604 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m13:33:45.792508 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:45.793438 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 13:33:45.766851 => 13:33:45.793304
[0m13:33:45.793698 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m13:33:45.794348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5d900>]}
[0m13:33:45.794840 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1440[0m in 0.03s]
[0m13:33:45.795462 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m13:33:45.796875 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m13:33:45.797268 [info ] [Thread-1 (]: 3 of 3 START sql table model public.fct_daily_energy ........................... [RUN]
[0m13:33:45.798075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m13:33:45.798398 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m13:33:45.800686 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m13:33:45.801722 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 13:33:45.798572 => 13:33:45.801544
[0m13:33:45.802000 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m13:33:45.828854 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m13:33:45.829817 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:33:45.830155 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m13:33:45.830452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:45.835539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:45.835874 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:33:45.836233 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m13:33:45.839537 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0.0 seconds
[0m13:33:45.842024 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:33:45.842367 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy" rename to "fct_daily_energy__dbt_backup"
[0m13:33:45.842835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:45.845093 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:33:45.845432 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m13:33:45.845857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:45.847351 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:33:45.847637 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:33:45.847882 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:33:45.848401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:33:45.850192 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m13:33:45.850754 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:33:45.851026 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m13:33:45.851967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:45.852996 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 13:33:45.802185 => 13:33:45.852850
[0m13:33:45.853276 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m13:33:45.853863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df57c250-fd91-4560-b835-6ef3f63ec9fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75e5f0>]}
[0m13:33:45.854370 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 60[0m in 0.06s]
[0m13:33:45.854985 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m13:33:45.856141 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:45.856438 [debug] [MainThread]: On master: BEGIN
[0m13:33:45.856698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:45.861681 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:45.861949 [debug] [MainThread]: On master: COMMIT
[0m13:33:45.862188 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:45.862406 [debug] [MainThread]: On master: COMMIT
[0m13:33:45.862692 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:45.862904 [debug] [MainThread]: On master: Close
[0m13:33:45.863434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:45.863692 [debug] [MainThread]: Connection 'model.energy_analytics.fct_daily_energy' was properly closed.
[0m13:33:45.864156 [info ] [MainThread]: 
[0m13:33:45.864511 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m13:33:45.865424 [debug] [MainThread]: Command end result
[0m13:33:45.871963 [info ] [MainThread]: 
[0m13:33:45.872434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:45.872803 [info ] [MainThread]: 
[0m13:33:45.873257 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:33:45.874299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cff2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca7f40>]}
[0m13:33:45.874605 [debug] [MainThread]: Flushing usage events
[0m13:33:54.152411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>]}


============================== 13:33:54.158569 | ae1355d7-caa9-4117-ab35-faf6196101bc ==============================
[0m13:33:54.158569 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:33:54.159447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:54.277195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae1355d7-caa9-4117-ab35-faf6196101bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dc00>]}
[0m13:33:54.334810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae1355d7-caa9-4117-ab35-faf6196101bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8d30>]}
[0m13:33:54.335466 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:33:54.343809 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:33:54.370511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:54.371013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:54.376552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae1355d7-caa9-4117-ab35-faf6196101bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af5e10>]}
[0m13:33:54.386666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae1355d7-caa9-4117-ab35-faf6196101bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8af0>]}
[0m13:33:54.387141 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:33:54.387564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1355d7-caa9-4117-ab35-faf6196101bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8c40>]}
[0m13:33:54.389467 [info ] [MainThread]: 
[0m13:33:54.390421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:54.392938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:33:54.402208 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:54.402691 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:33:54.402996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:54.440818 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.441426 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:33:54.441830 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:33:54.443884 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:33:54.445415 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:33:54.445842 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:33:54.451798 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:54.452241 [debug] [MainThread]: On master: BEGIN
[0m13:33:54.452559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:54.458024 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.458490 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:54.458882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:54.463388 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:33:54.464507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1355d7-caa9-4117-ab35-faf6196101bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cabc10>]}
[0m13:33:54.464992 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:54.465449 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:54.465822 [debug] [MainThread]: On master: BEGIN
[0m13:33:54.466338 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.466685 [debug] [MainThread]: On master: COMMIT
[0m13:33:54.466965 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:54.467233 [debug] [MainThread]: On master: COMMIT
[0m13:33:54.467629 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:54.467946 [debug] [MainThread]: On master: Close
[0m13:33:54.468598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:54.468946 [info ] [MainThread]: 
[0m13:33:54.472010 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:54.472599 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m13:33:54.473494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m13:33:54.473880 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:54.486575 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:54.487665 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 13:33:54.474128 => 13:33:54.487484
[0m13:33:54.488029 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:54.498394 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:54.499596 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:54.499937 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m13:33:54.500219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:54.505408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.505769 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:33:54.506068 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m13:33:54.506741 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:54.508486 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 13:33:54.488226 => 13:33:54.508277
[0m13:33:54.508849 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m13:33:54.509284 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m13:33:54.510413 [error] [Thread-1 (]: 1 of 5 FAIL 1 not_null_stg_households_household_id ............................. [[31mFAIL 1[0m in 0.04s]
[0m13:33:54.511439 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:33:54.512006 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:54.512464 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m13:33:54.513318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m13:33:54.513677 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:54.517291 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:54.518368 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 13:33:54.513926 => 13:33:54.518127
[0m13:33:54.518726 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:54.520745 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:54.521483 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:54.521804 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m13:33:54.522084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:54.527768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.528272 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:33:54.528633 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m13:33:54.529434 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:54.530972 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 13:33:54.518967 => 13:33:54.530767
[0m13:33:54.531475 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m13:33:54.531933 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m13:33:54.532761 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_households_meter_id ................................... [[32mPASS[0m in 0.02s]
[0m13:33:54.533520 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:33:54.533954 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:54.534366 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m13:33:54.535030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m13:33:54.535354 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:54.539005 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:54.540075 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 13:33:54.535601 => 13:33:54.539842
[0m13:33:54.540482 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:54.542526 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:54.543487 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:54.543862 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m13:33:54.544188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:54.549960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.550541 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:33:54.550904 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m13:33:54.551832 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:54.553329 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 13:33:54.540715 => 13:33:54.553071
[0m13:33:54.553823 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m13:33:54.554412 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m13:33:54.555237 [info ] [Thread-1 (]: 3 of 5 PASS not_null_stg_smart_meter_readings_meter_id ......................... [[32mPASS[0m in 0.02s]
[0m13:33:54.555933 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:33:54.556430 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:54.556904 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m13:33:54.557629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m13:33:54.557993 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:54.562477 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:54.563503 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 13:33:54.558229 => 13:33:54.563283
[0m13:33:54.563866 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:54.565913 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:54.566807 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:54.567181 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m13:33:54.567506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:54.573167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.573635 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:33:54.573928 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m13:33:54.574623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:54.575909 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 13:33:54.564123 => 13:33:54.575744
[0m13:33:54.576410 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m13:33:54.576897 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m13:33:54.577690 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_smart_meter_readings_reading_time ..................... [[32mPASS[0m in 0.02s]
[0m13:33:54.578372 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:33:54.578749 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:54.579176 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m13:33:54.579853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m13:33:54.580240 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:54.585167 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:54.586069 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 13:33:54.580481 => 13:33:54.585887
[0m13:33:54.586424 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:54.588151 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:54.588978 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:54.589271 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m13:33:54.589554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:54.594563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.594862 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:33:54.595122 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:33:54.595890 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:33:54.597180 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 13:33:54.586621 => 13:33:54.596972
[0m13:33:54.597623 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m13:33:54.598088 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m13:33:54.598835 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_households_household_id ................................. [[32mPASS[0m in 0.02s]
[0m13:33:54.599446 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:33:54.601256 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:54.601568 [debug] [MainThread]: On master: BEGIN
[0m13:33:54.601817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:54.606634 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:54.606915 [debug] [MainThread]: On master: COMMIT
[0m13:33:54.607173 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:54.607443 [debug] [MainThread]: On master: COMMIT
[0m13:33:54.607753 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:54.608004 [debug] [MainThread]: On master: Close
[0m13:33:54.608544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:54.608822 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m13:33:54.609297 [info ] [MainThread]: 
[0m13:33:54.609714 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:33:54.610753 [debug] [MainThread]: Command end result
[0m13:33:54.617268 [info ] [MainThread]: 
[0m13:33:54.617713 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:33:54.618055 [info ] [MainThread]: 
[0m13:33:54.618447 [error] [MainThread]: [31mFailure in test not_null_stg_households_household_id (models/schema.yml)[0m
[0m13:33:54.618771 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:33:54.619094 [info ] [MainThread]: 
[0m13:33:54.619466 [info ] [MainThread]:   compiled Code at target/compiled/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m13:33:54.619789 [info ] [MainThread]: 
[0m13:33:54.620213 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:33:54.621695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cab520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b68580>]}
[0m13:33:54.622173 [debug] [MainThread]: Flushing usage events
[0m13:45:44.614781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4df730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>]}


============================== 13:45:44.621631 | 17f610b0-ce42-483c-bd46-f9420decfda0 ==============================
[0m13:45:44.621631 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:45:44.622412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:44.742877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17f610b0-ce42-483c-bd46-f9420decfda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dc30>]}
[0m13:45:44.800885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17f610b0-ce42-483c-bd46-f9420decfda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfef20>]}
[0m13:45:44.801507 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:45:44.810209 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:45:44.836453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:45:44.836835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:45:44.841660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17f610b0-ce42-483c-bd46-f9420decfda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af1e40>]}
[0m13:45:44.852421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17f610b0-ce42-483c-bd46-f9420decfda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8b20>]}
[0m13:45:44.852782 [info ] [MainThread]: Found 4 models, 3 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:45:44.853184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f610b0-ce42-483c-bd46-f9420decfda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8c70>]}
[0m13:45:44.854788 [info ] [MainThread]: 
[0m13:45:44.855590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:44.857714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:45:44.866537 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:45:44.866920 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:45:44.867229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:44.903729 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:45:44.904189 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:45:44.904495 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:45:44.907397 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:45:44.908792 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:45:44.909192 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:45:44.914534 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:44.914882 [debug] [MainThread]: On master: BEGIN
[0m13:45:44.915151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:44.919977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:44.920299 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:44.920648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:45:44.925002 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:45:44.925852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f610b0-ce42-483c-bd46-f9420decfda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cabc40>]}
[0m13:45:44.926234 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:44.926576 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:44.926838 [debug] [MainThread]: On master: BEGIN
[0m13:45:44.927261 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:44.927523 [debug] [MainThread]: On master: COMMIT
[0m13:45:44.927765 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:44.928006 [debug] [MainThread]: On master: COMMIT
[0m13:45:44.928307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:45:44.928577 [debug] [MainThread]: On master: Close
[0m13:45:44.929105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:44.929511 [info ] [MainThread]: 
[0m13:45:44.932115 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:45:44.932549 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m13:45:44.933287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m13:45:44.933635 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:45:44.945353 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:45:44.947835 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 13:45:44.933844 => 13:45:44.947647
[0m13:45:44.948135 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:45:44.958527 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:45:44.959669 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:45:44.959968 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m13:45:44.960258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:44.965640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:45:44.965958 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:45:44.966241 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m13:45:44.967029 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:45:44.968577 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 13:45:44.948367 => 13:45:44.968410
[0m13:45:44.968901 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m13:45:44.969296 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m13:45:44.970372 [error] [Thread-1 (]: 1 of 5 FAIL 1 not_null_stg_households_household_id ............................. [[31mFAIL 1[0m in 0.04s]
[0m13:45:44.971261 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:45:44.971746 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:45:44.972117 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m13:45:44.972745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m13:45:44.973042 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:45:44.976123 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:45:44.977253 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 13:45:44.973233 => 13:45:44.977084
[0m13:45:44.977547 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:45:44.979179 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:45:44.979969 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:45:44.980285 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m13:45:44.980570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:44.985633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:45:44.985938 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:45:44.986227 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m13:45:44.986828 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:45:44.987942 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 13:45:44.977748 => 13:45:44.987776
[0m13:45:44.988320 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m13:45:44.988802 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m13:45:44.989558 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_households_meter_id ................................... [[32mPASS[0m in 0.02s]
[0m13:45:44.990155 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:45:44.990571 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:45:44.990933 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m13:45:44.991580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m13:45:44.991879 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:45:44.995114 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:45:44.996257 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 13:45:44.992114 => 13:45:44.996097
[0m13:45:44.996560 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:45:44.998271 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:45:44.998875 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:45:44.999180 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m13:45:44.999475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:45.004428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:45:45.004821 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:45:45.005121 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m13:45:45.005945 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:45:45.006978 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 13:45:44.996744 => 13:45:45.006830
[0m13:45:45.007263 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m13:45:45.007665 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m13:45:45.008393 [info ] [Thread-1 (]: 3 of 5 PASS not_null_stg_smart_meter_readings_meter_id ......................... [[32mPASS[0m in 0.02s]
[0m13:45:45.009021 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:45:45.009428 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:45:45.009796 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m13:45:45.010441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m13:45:45.010721 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:45:45.014495 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:45:45.015518 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 13:45:45.010884 => 13:45:45.015348
[0m13:45:45.015797 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:45:45.017456 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:45:45.018093 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:45:45.018397 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m13:45:45.018668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:45.023732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:45:45.024009 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:45:45.024318 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m13:45:45.025029 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:45:45.026109 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 13:45:45.015998 => 13:45:45.025956
[0m13:45:45.026412 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m13:45:45.026865 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m13:45:45.027632 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_smart_meter_readings_reading_time ..................... [[32mPASS[0m in 0.02s]
[0m13:45:45.028360 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:45:45.028720 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:45:45.029049 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m13:45:45.029687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m13:45:45.029964 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:45:45.034572 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:45:45.035500 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 13:45:45.030157 => 13:45:45.035298
[0m13:45:45.035793 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:45:45.037456 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:45:45.038303 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:45:45.038602 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m13:45:45.038868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:45.043917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:45:45.044252 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:45:45.044564 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:45:45.045295 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:45:45.046488 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 13:45:45.035959 => 13:45:45.046310
[0m13:45:45.046835 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m13:45:45.047205 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m13:45:45.047905 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_households_household_id ................................. [[32mPASS[0m in 0.02s]
[0m13:45:45.048595 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:45:45.050404 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:45.050660 [debug] [MainThread]: On master: BEGIN
[0m13:45:45.050855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:45.055983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:45.056314 [debug] [MainThread]: On master: COMMIT
[0m13:45:45.056580 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:45.056822 [debug] [MainThread]: On master: COMMIT
[0m13:45:45.057144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:45:45.057451 [debug] [MainThread]: On master: Close
[0m13:45:45.057985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:45.058277 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m13:45:45.058735 [info ] [MainThread]: 
[0m13:45:45.059099 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:45:45.060130 [debug] [MainThread]: Command end result
[0m13:45:45.067102 [info ] [MainThread]: 
[0m13:45:45.067551 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:45:45.067857 [info ] [MainThread]: 
[0m13:45:45.068245 [error] [MainThread]: [31mFailure in test not_null_stg_households_household_id (models/schema.yml)[0m
[0m13:45:45.068552 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:45:45.068824 [info ] [MainThread]: 
[0m13:45:45.069110 [info ] [MainThread]:   compiled Code at target/compiled/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m13:45:45.069473 [info ] [MainThread]: 
[0m13:45:45.069924 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:45:45.070915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4df730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cabf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8370>]}
[0m13:45:45.071273 [debug] [MainThread]: Flushing usage events
[0m13:54:42.748275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>]}


============================== 13:54:42.755599 | 5e6bbeb8-447a-4329-be87-9351ed0d3e65 ==============================
[0m13:54:42.755599 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:54:42.756388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:54:42.884764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dc00>]}
[0m13:54:42.942723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfab30>]}
[0m13:54:42.943345 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:54:42.951797 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:54:42.978901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:54:42.979477 [debug] [MainThread]: Partial parsing: updated file: energy_analytics://data/smart_meter_readings.csv
[0m13:54:42.979890 [debug] [MainThread]: Partial parsing: updated file: energy_analytics://models/fact/fct_energy_cost.sql
[0m13:54:43.222578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c85ba0>]}
[0m13:54:43.233273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca7d90>]}
[0m13:54:43.233683 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:54:43.234120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca7f10>]}
[0m13:54:43.235620 [info ] [MainThread]: 
[0m13:54:43.236352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:43.237755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:54:43.246006 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:54:43.246335 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:54:43.246571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:43.284734 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:54:43.286092 [debug] [ThreadPool]: On list_analytics: Close
[0m13:54:43.288286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:54:43.292402 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:54:43.292710 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:54:43.293004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:43.298118 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:54:43.298404 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:54:43.298714 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:43.300704 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:54:43.301718 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:54:43.302133 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:54:43.306301 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:43.306620 [debug] [MainThread]: On master: BEGIN
[0m13:54:43.306877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:43.311706 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:43.311987 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:43.312321 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:43.316868 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:54:43.317769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83637c0>]}
[0m13:54:43.318114 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:43.318434 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:43.318733 [debug] [MainThread]: On master: BEGIN
[0m13:54:43.319147 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:43.319405 [debug] [MainThread]: On master: COMMIT
[0m13:54:43.319689 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:43.319970 [debug] [MainThread]: On master: COMMIT
[0m13:54:43.320279 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:43.320536 [debug] [MainThread]: On master: Close
[0m13:54:43.321053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:43.321428 [info ] [MainThread]: 
[0m13:54:43.323780 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m13:54:43.324224 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m13:54:43.324860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m13:54:43.325176 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m13:54:43.325581 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 13:54:43.325387 => 13:54:43.325389
[0m13:54:43.325897 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m13:54:43.348069 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:54:43.348452 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m13:54:43.348782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:43.353891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:43.354194 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:54:43.354492 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */
truncate table "analytics"."public"."households"
[0m13:54:43.357564 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:54:43.375052 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:54:43.376029 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:54:43.377798 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m13:54:43.382175 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m13:54:43.392549 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:54:43.392843 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:54:43.393112 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:54:43.394487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:43.395406 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 13:54:43.326100 => 13:54:43.395228
[0m13:54:43.395826 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m13:54:43.396512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75e470>]}
[0m13:54:43.397348 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 11[0m in 0.07s]
[0m13:54:43.398096 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m13:54:43.398479 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m13:54:43.398937 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m13:54:43.399539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m13:54:43.399905 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m13:54:43.400304 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 13:54:43.400144 => 13:54:43.400145
[0m13:54:43.400617 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m13:54:43.446602 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:54:43.447131 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m13:54:43.447488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:43.453629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:43.454141 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:54:43.454503 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */
truncate table "analytics"."public"."smart_meter_readings"
[0m13:54:43.456452 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:54:44.499654 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:54:44.500239 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m13:54:44.513772 [debug] [Thread-1 (]: SQL status: INSERT 0 1442 in 0.0 seconds
[0m13:54:44.514670 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m13:54:44.518496 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:54:44.518856 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:54:44.519174 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:54:44.520359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:44.521024 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 13:54:43.400816 => 13:54:44.520884
[0m13:54:44.521300 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m13:54:44.521890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af51e0>]}
[0m13:54:44.522352 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1442[0m in 1.12s]
[0m13:54:44.522944 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m13:54:44.523296 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m13:54:44.523687 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m13:54:44.524309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m13:54:44.524634 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m13:54:44.525008 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 13:54:44.524855 => 13:54:44.524856
[0m13:54:44.525259 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m13:54:44.529564 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:54:44.529938 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m13:54:44.530287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:44.535917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:44.536258 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:54:44.536584 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */
truncate table "analytics"."public"."tariff_rates"
[0m13:54:44.537194 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:54:44.539919 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:54:44.540235 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:54:44.540869 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m13:54:44.541452 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m13:54:44.543170 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:54:44.543454 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:54:44.543736 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:54:44.544604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:54:44.545207 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 13:54:44.525416 => 13:54:44.545079
[0m13:54:44.545453 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m13:54:44.546035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6bbeb8-447a-4329-be87-9351ed0d3e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8257eb0>]}
[0m13:54:44.546484 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m13:54:44.547071 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m13:54:44.548953 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:44.549213 [debug] [MainThread]: On master: BEGIN
[0m13:54:44.549416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:44.554962 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:44.555345 [debug] [MainThread]: On master: COMMIT
[0m13:54:44.555609 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:44.555918 [debug] [MainThread]: On master: COMMIT
[0m13:54:44.556221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:44.556484 [debug] [MainThread]: On master: Close
[0m13:54:44.557022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:44.557279 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m13:54:44.557756 [info ] [MainThread]: 
[0m13:54:44.558141 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m13:54:44.558920 [debug] [MainThread]: Command end result
[0m13:54:44.565037 [info ] [MainThread]: 
[0m13:54:44.565422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:44.565851 [info ] [MainThread]: 
[0m13:54:44.566295 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:54:44.567273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb712350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83637c0>]}
[0m13:54:44.567601 [debug] [MainThread]: Flushing usage events
[0m13:54:51.959108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 13:54:51.965223 | e0726aca-10dd-458c-9dba-a21a3b746a64 ==============================
[0m13:54:51.965223 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:54:51.966023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:52.080140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0726aca-10dd-458c-9dba-a21a3b746a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m13:54:52.138773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0726aca-10dd-458c-9dba-a21a3b746a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfe9b0>]}
[0m13:54:52.139396 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:54:52.146511 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:54:52.169630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:52.169982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:52.174834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0726aca-10dd-458c-9dba-a21a3b746a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afded0>]}
[0m13:54:52.184485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0726aca-10dd-458c-9dba-a21a3b746a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca90>]}
[0m13:54:52.184901 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:54:52.185274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0726aca-10dd-458c-9dba-a21a3b746a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcc10>]}
[0m13:54:52.186736 [info ] [MainThread]: 
[0m13:54:52.187537 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:52.189689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:54:52.198164 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:54:52.198488 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:54:52.198824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:52.232866 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.233312 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:54:52.233646 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:52.235271 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:54:52.236569 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:54:52.236966 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:54:52.242026 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:52.242345 [debug] [MainThread]: On master: BEGIN
[0m13:54:52.242613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:52.247268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.247557 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:52.247918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:52.251780 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:54:52.252641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0726aca-10dd-458c-9dba-a21a3b746a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb716320>]}
[0m13:54:52.253024 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:52.253346 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:52.253598 [debug] [MainThread]: On master: BEGIN
[0m13:54:52.254011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.254263 [debug] [MainThread]: On master: COMMIT
[0m13:54:52.254513 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:52.254804 [debug] [MainThread]: On master: COMMIT
[0m13:54:52.255103 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:52.255352 [debug] [MainThread]: On master: Close
[0m13:54:52.255899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:52.256276 [info ] [MainThread]: 
[0m13:54:52.258819 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:52.259246 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m13:54:52.259942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m13:54:52.260271 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:52.282348 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:52.286272 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 13:54:52.260508 => 13:54:52.285460
[0m13:54:52.287376 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:52.304404 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:52.305533 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:52.305878 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m13:54:52.306194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:52.311605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.311949 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:52.312284 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m13:54:52.313090 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:52.314773 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 13:54:52.288067 => 13:54:52.314588
[0m13:54:52.315064 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m13:54:52.315381 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m13:54:52.316405 [error] [Thread-1 (]: 1 of 5 FAIL 1 not_null_stg_households_household_id ............................. [[31mFAIL 1[0m in 0.06s]
[0m13:54:52.317314 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:52.317823 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:52.318258 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m13:54:52.318891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m13:54:52.319206 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:52.322420 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:52.323394 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 13:54:52.319412 => 13:54:52.323225
[0m13:54:52.323757 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:52.325596 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:52.326257 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:52.326538 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m13:54:52.326803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:52.332015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.332431 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:52.332810 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m13:54:52.333440 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:52.334622 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 13:54:52.323981 => 13:54:52.334420
[0m13:54:52.335014 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m13:54:52.335507 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m13:54:52.336283 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_households_meter_id ................................... [[32mPASS[0m in 0.02s]
[0m13:54:52.336951 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:52.337320 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:52.337677 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m13:54:52.338261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m13:54:52.338532 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:52.341909 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:52.342820 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 13:54:52.338729 => 13:54:52.342628
[0m13:54:52.343148 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:52.344995 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:52.345708 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:52.346027 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m13:54:52.346267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:52.351753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.352179 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:52.352478 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m13:54:52.353322 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:52.354566 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 13:54:52.343385 => 13:54:52.354367
[0m13:54:52.354894 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m13:54:52.355426 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m13:54:52.356249 [info ] [Thread-1 (]: 3 of 5 PASS not_null_stg_smart_meter_readings_meter_id ......................... [[32mPASS[0m in 0.02s]
[0m13:54:52.356924 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:52.357348 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:52.357793 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m13:54:52.358575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m13:54:52.358892 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:52.363246 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:52.364242 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 13:54:52.359065 => 13:54:52.364084
[0m13:54:52.364558 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:52.366561 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:52.367600 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:52.367933 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m13:54:52.368181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:52.373550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.373934 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:52.374245 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m13:54:52.375030 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:52.376217 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 13:54:52.364805 => 13:54:52.376052
[0m13:54:52.376610 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m13:54:52.377064 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m13:54:52.377784 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_smart_meter_readings_reading_time ..................... [[32mPASS[0m in 0.02s]
[0m13:54:52.378502 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:52.378929 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:52.379305 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m13:54:52.379957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m13:54:52.380256 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:52.385221 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:52.386204 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 13:54:52.380449 => 13:54:52.386042
[0m13:54:52.386495 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:52.388297 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:52.388912 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:52.389228 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m13:54:52.389545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:52.394853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.395250 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:52.395551 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:54:52.396344 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:52.397728 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 13:54:52.386728 => 13:54:52.397533
[0m13:54:52.398097 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m13:54:52.398571 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m13:54:52.399340 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_households_household_id ................................. [[32mPASS[0m in 0.02s]
[0m13:54:52.399878 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:52.401780 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:52.402046 [debug] [MainThread]: On master: BEGIN
[0m13:54:52.402274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:52.407281 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:52.407617 [debug] [MainThread]: On master: COMMIT
[0m13:54:52.407897 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:52.408153 [debug] [MainThread]: On master: COMMIT
[0m13:54:52.408506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:52.408798 [debug] [MainThread]: On master: Close
[0m13:54:52.409308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:52.409572 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m13:54:52.410034 [info ] [MainThread]: 
[0m13:54:52.410417 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:54:52.411437 [debug] [MainThread]: Command end result
[0m13:54:52.418025 [info ] [MainThread]: 
[0m13:54:52.418431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:54:52.418835 [info ] [MainThread]: 
[0m13:54:52.419175 [error] [MainThread]: [31mFailure in test not_null_stg_households_household_id (models/schema.yml)[0m
[0m13:54:52.419525 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:54:52.419921 [info ] [MainThread]: 
[0m13:54:52.420270 [info ] [MainThread]:   compiled Code at target/compiled/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m13:54:52.420631 [info ] [MainThread]: 
[0m13:54:52.421073 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:54:52.422103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e88460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9adb910>]}
[0m13:54:52.422463 [debug] [MainThread]: Flushing usage events
[0m13:54:56.549982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75da50>]}


============================== 13:54:56.556233 | d119493f-5143-4083-856f-c0f93b329bf9 ==============================
[0m13:54:56.556233 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:54:56.557046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:56.673728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd119493f-5143-4083-856f-c0f93b329bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>]}
[0m13:54:56.733475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd119493f-5143-4083-856f-c0f93b329bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfc1c0>]}
[0m13:54:56.734229 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:54:56.741677 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:54:56.765060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:56.765489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:56.770773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd119493f-5143-4083-856f-c0f93b329bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b01e40>]}
[0m13:54:56.781486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd119493f-5143-4083-856f-c0f93b329bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcac0>]}
[0m13:54:56.781920 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:54:56.782266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd119493f-5143-4083-856f-c0f93b329bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcb20>]}
[0m13:54:56.783906 [info ] [MainThread]: 
[0m13:54:56.784821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:56.787222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:54:56.796155 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:54:56.796597 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:54:56.796905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:56.832771 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:54:56.833264 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:54:56.833637 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:56.835352 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:54:56.836724 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:54:56.837124 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:54:56.842445 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:56.842784 [debug] [MainThread]: On master: BEGIN
[0m13:54:56.843042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:56.848238 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:56.848526 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:56.848900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:56.852916 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:54:56.853798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd119493f-5143-4083-856f-c0f93b329bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cab100>]}
[0m13:54:56.854207 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:56.854550 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:56.854808 [debug] [MainThread]: On master: BEGIN
[0m13:54:56.855232 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:56.855495 [debug] [MainThread]: On master: COMMIT
[0m13:54:56.855766 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:56.856003 [debug] [MainThread]: On master: COMMIT
[0m13:54:56.856307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:56.856567 [debug] [MainThread]: On master: Close
[0m13:54:56.857172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:56.857511 [info ] [MainThread]: 
[0m13:54:56.860172 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:56.860561 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m13:54:56.861273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m13:54:56.861604 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:56.875311 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:56.876332 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 13:54:56.861845 => 13:54:56.876086
[0m13:54:56.876853 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:56.892080 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:56.893461 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:56.897311 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m13:54:56.905459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:56.923513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:56.924689 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:54:56.925234 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m13:54:56.926210 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:56.928066 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 13:54:56.877123 => 13:54:56.927872
[0m13:54:56.928433 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m13:54:56.928854 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m13:54:56.929942 [error] [Thread-1 (]: 1 of 5 FAIL 1 not_null_stg_households_household_id ............................. [[31mFAIL 1[0m in 0.07s]
[0m13:54:56.930849 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:54:56.931254 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:56.931695 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m13:54:56.932489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m13:54:56.932887 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:56.936473 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:56.937506 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 13:54:56.933116 => 13:54:56.937286
[0m13:54:56.937834 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:56.939577 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:56.940202 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:56.940565 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m13:54:56.940924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:56.946382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:56.946761 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:54:56.947066 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m13:54:56.947705 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:56.948993 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 13:54:56.938042 => 13:54:56.948809
[0m13:54:56.949378 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m13:54:56.949957 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m13:54:56.950739 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_households_meter_id ................................... [[32mPASS[0m in 0.02s]
[0m13:54:56.951499 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:54:56.951958 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:56.952385 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m13:54:56.953073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m13:54:56.953365 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:56.956800 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:56.957858 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 13:54:56.953533 => 13:54:56.957631
[0m13:54:56.958268 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:56.960207 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:56.960899 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:56.961192 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m13:54:56.961484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:56.966963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:56.967348 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:54:56.967659 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m13:54:56.968364 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:56.969611 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 13:54:56.958517 => 13:54:56.969416
[0m13:54:56.969992 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m13:54:56.970486 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m13:54:56.971293 [info ] [Thread-1 (]: 3 of 5 PASS not_null_stg_smart_meter_readings_meter_id ......................... [[32mPASS[0m in 0.02s]
[0m13:54:56.971958 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:54:56.972312 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:56.972674 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m13:54:56.973390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m13:54:56.973796 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:56.978031 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:56.979020 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 13:54:56.974070 => 13:54:56.978812
[0m13:54:56.979344 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:56.981097 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:56.981730 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:56.982030 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m13:54:56.982294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:56.987668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:56.988033 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:54:56.988315 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m13:54:56.989062 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:56.990238 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 13:54:56.979554 => 13:54:56.990053
[0m13:54:56.990751 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m13:54:56.991404 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m13:54:56.992212 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_smart_meter_readings_reading_time ..................... [[32mPASS[0m in 0.02s]
[0m13:54:56.992981 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:54:56.993362 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:56.993760 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m13:54:56.994394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m13:54:56.994677 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:56.999830 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:57.000903 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 13:54:56.994932 => 13:54:57.000606
[0m13:54:57.001210 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:57.002994 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:57.003577 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:57.003920 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m13:54:57.004196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:57.009796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:54:57.010271 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:54:57.010607 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:54:57.011478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:54:57.013136 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 13:54:57.001409 => 13:54:57.012926
[0m13:54:57.013822 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m13:54:57.014187 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m13:54:57.014905 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_households_household_id ................................. [[32mPASS[0m in 0.02s]
[0m13:54:57.015655 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:54:57.017622 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:57.017933 [debug] [MainThread]: On master: BEGIN
[0m13:54:57.018168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:57.023469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:57.023912 [debug] [MainThread]: On master: COMMIT
[0m13:54:57.024241 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:57.024547 [debug] [MainThread]: On master: COMMIT
[0m13:54:57.024929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:57.025222 [debug] [MainThread]: On master: Close
[0m13:54:57.025800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:57.026064 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m13:54:57.026552 [info ] [MainThread]: 
[0m13:54:57.027049 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:54:57.028326 [debug] [MainThread]: Command end result
[0m13:54:57.034833 [info ] [MainThread]: 
[0m13:54:57.035305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:54:57.035655 [info ] [MainThread]: 
[0m13:54:57.035992 [error] [MainThread]: [31mFailure in test not_null_stg_households_household_id (models/schema.yml)[0m
[0m13:54:57.036330 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:54:57.036695 [info ] [MainThread]: 
[0m13:54:57.037018 [info ] [MainThread]:   compiled Code at target/compiled/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m13:54:57.037383 [info ] [MainThread]: 
[0m13:54:57.037890 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:54:57.038991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca9db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcbe0>]}
[0m13:54:57.039360 [debug] [MainThread]: Flushing usage events
[0m13:55:03.049867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>]}


============================== 13:55:03.056059 | 53705a0b-3d4b-4f9b-b194-66fd1a17f894 ==============================
[0m13:55:03.056059 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:55:03.056882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m13:55:03.172608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dc00>]}
[0m13:55:03.229391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8d30>]}
[0m13:55:03.230004 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:55:03.237218 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:55:03.260023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:03.260574 [debug] [MainThread]: Partial parsing: updated file: energy_analytics://data/households.csv
[0m13:55:03.337292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a040d0>]}
[0m13:55:03.345611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8b80>]}
[0m13:55:03.346155 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:55:03.346642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8be0>]}
[0m13:55:03.348140 [info ] [MainThread]: 
[0m13:55:03.348966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:03.351155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:55:03.358846 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:55:03.359191 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:55:03.359443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:03.394847 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:55:03.396177 [debug] [ThreadPool]: On list_analytics: Close
[0m13:55:03.398327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:55:03.402520 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:55:03.402849 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:55:03.403120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:03.408317 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:55:03.408637 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:55:03.408994 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:03.410221 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:55:03.411249 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:55:03.411645 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:55:03.416067 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:03.416398 [debug] [MainThread]: On master: BEGIN
[0m13:55:03.416649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:03.421422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:55:03.421722 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:03.422065 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:03.425931 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:55:03.426745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca76d0>]}
[0m13:55:03.427138 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:03.427478 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:03.427741 [debug] [MainThread]: On master: BEGIN
[0m13:55:03.428174 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:55:03.428428 [debug] [MainThread]: On master: COMMIT
[0m13:55:03.428706 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:03.428982 [debug] [MainThread]: On master: COMMIT
[0m13:55:03.429294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:55:03.429559 [debug] [MainThread]: On master: Close
[0m13:55:03.430106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:03.430478 [info ] [MainThread]: 
[0m13:55:03.432691 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m13:55:03.433107 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m13:55:03.433699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m13:55:03.434004 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m13:55:03.434376 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 13:55:03.434209 => 13:55:03.434210
[0m13:55:03.434693 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m13:55:03.456182 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:55:03.456549 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m13:55:03.456913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:03.461996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:03.462299 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:55:03.462607 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */
truncate table "analytics"."public"."households"
[0m13:55:03.464954 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:55:03.503048 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:55:03.503522 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:55:03.505239 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m13:55:03.509336 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m13:55:03.519558 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:55:03.519882 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:55:03.520140 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:55:03.520937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:55:03.521658 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 13:55:03.434904 => 13:55:03.521487
[0m13:55:03.521991 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m13:55:03.522704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a4add0>]}
[0m13:55:03.523604 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 11[0m in 0.09s]
[0m13:55:03.524335 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m13:55:03.524731 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m13:55:03.525162 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m13:55:03.525766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m13:55:03.526065 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m13:55:03.526381 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 13:55:03.526244 => 13:55:03.526245
[0m13:55:03.526637 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m13:55:03.569978 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:55:03.570321 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m13:55:03.570624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:03.575662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:03.575979 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:55:03.576281 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */
truncate table "analytics"."public"."smart_meter_readings"
[0m13:55:03.578482 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:55:04.622056 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:55:04.622670 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m13:55:04.635277 [debug] [Thread-1 (]: SQL status: INSERT 0 1442 in 0.0 seconds
[0m13:55:04.636225 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m13:55:04.638551 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:55:04.639015 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:55:04.639385 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:55:04.640609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:55:04.641407 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 13:55:03.526835 => 13:55:04.641245
[0m13:55:04.641706 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m13:55:04.642368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a49db0>]}
[0m13:55:04.642905 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1442[0m in 1.12s]
[0m13:55:04.643525 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m13:55:04.643947 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m13:55:04.644392 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m13:55:04.645044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m13:55:04.645406 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m13:55:04.645847 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 13:55:04.645657 => 13:55:04.645659
[0m13:55:04.646163 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m13:55:04.651025 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:55:04.651417 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m13:55:04.651740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:04.657560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:04.658119 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:55:04.658477 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */
truncate table "analytics"."public"."tariff_rates"
[0m13:55:04.659175 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m13:55:04.662012 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:55:04.662401 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:55:04.663094 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m13:55:04.663791 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m13:55:04.665852 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:55:04.666194 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:55:04.666500 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:55:04.667350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:55:04.668146 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 13:55:04.646357 => 13:55:04.667981
[0m13:55:04.668443 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m13:55:04.669116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53705a0b-3d4b-4f9b-b194-66fd1a17f894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ad6d10>]}
[0m13:55:04.669575 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m13:55:04.670327 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m13:55:04.672213 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:04.672515 [debug] [MainThread]: On master: BEGIN
[0m13:55:04.672766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:04.678762 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:55:04.679228 [debug] [MainThread]: On master: COMMIT
[0m13:55:04.679521 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:04.679815 [debug] [MainThread]: On master: COMMIT
[0m13:55:04.680202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:55:04.680501 [debug] [MainThread]: On master: Close
[0m13:55:04.681113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:04.681389 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m13:55:04.681943 [info ] [MainThread]: 
[0m13:55:04.682339 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m13:55:04.683270 [debug] [MainThread]: Command end result
[0m13:55:04.690218 [info ] [MainThread]: 
[0m13:55:04.690747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:04.691216 [info ] [MainThread]: 
[0m13:55:04.691786 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:55:04.693012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ac4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ac59c0>]}
[0m13:55:04.693374 [debug] [MainThread]: Flushing usage events
[0m13:55:08.697005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 13:55:08.703121 | c953715d-9b02-4cf1-ab01-a9a18f167a8d ==============================
[0m13:55:08.703121 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:55:08.703922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:55:08.818198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c953715d-9b02-4cf1-ab01-a9a18f167a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m13:55:08.875886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c953715d-9b02-4cf1-ab01-a9a18f167a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8e80>]}
[0m13:55:08.876457 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:55:08.883403 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:55:08.906432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:08.906858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:08.911544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c953715d-9b02-4cf1-ab01-a9a18f167a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afded0>]}
[0m13:55:08.920199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c953715d-9b02-4cf1-ab01-a9a18f167a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8a90>]}
[0m13:55:08.920602 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:55:08.921077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c953715d-9b02-4cf1-ab01-a9a18f167a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8c10>]}
[0m13:55:08.922773 [info ] [MainThread]: 
[0m13:55:08.923616 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:08.925721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:55:08.934301 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:55:08.934684 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:55:08.935002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:08.970164 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:55:08.970648 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:55:08.970991 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:08.972624 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:55:08.974037 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:55:08.974423 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:55:08.979507 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.979837 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.980115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:08.984705 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:55:08.984999 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.985367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:08.989245 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:55:08.990115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c953715d-9b02-4cf1-ab01-a9a18f167a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb716320>]}
[0m13:55:08.990493 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:08.990903 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.991202 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.991640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:55:08.991907 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.992163 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.992409 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.992741 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:55:08.993031 [debug] [MainThread]: On master: Close
[0m13:55:08.993635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:08.994002 [info ] [MainThread]: 
[0m13:55:08.998086 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:55:08.998879 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m13:55:09.000451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m13:55:09.001191 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:55:09.018404 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:55:09.019645 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 13:55:09.001512 => 13:55:09.019431
[0m13:55:09.020739 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:55:09.034813 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:55:09.036089 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:55:09.036507 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m13:55:09.036974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.042865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:09.043380 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:55:09.043798 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m13:55:09.044529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:55:09.046527 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 13:55:09.021024 => 13:55:09.046280
[0m13:55:09.047006 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m13:55:09.047551 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m13:55:09.048971 [error] [Thread-1 (]: 1 of 5 FAIL 1 not_null_stg_households_household_id ............................. [[31mFAIL 1[0m in 0.05s]
[0m13:55:09.050122 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:55:09.050716 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:55:09.051243 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m13:55:09.052036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m13:55:09.052479 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:55:09.060044 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:55:09.062492 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 13:55:09.052874 => 13:55:09.061795
[0m13:55:09.063157 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:55:09.065126 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:55:09.065873 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:55:09.066220 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m13:55:09.066497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.071754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:09.072089 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:55:09.072477 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m13:55:09.073336 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:55:09.074707 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 13:55:09.063365 => 13:55:09.074495
[0m13:55:09.075047 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m13:55:09.075379 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m13:55:09.076072 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_households_meter_id ................................... [[32mPASS[0m in 0.02s]
[0m13:55:09.076697 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:55:09.077135 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:55:09.077527 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m13:55:09.078194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m13:55:09.078489 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:55:09.081646 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:55:09.082545 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 13:55:09.078728 => 13:55:09.082358
[0m13:55:09.082870 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:55:09.084572 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:55:09.085184 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:55:09.085501 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m13:55:09.085792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.090831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:09.091204 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:55:09.091490 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m13:55:09.092192 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:55:09.093282 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 13:55:09.083077 => 13:55:09.093117
[0m13:55:09.093565 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m13:55:09.094067 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m13:55:09.094882 [info ] [Thread-1 (]: 3 of 5 PASS not_null_stg_smart_meter_readings_meter_id ......................... [[32mPASS[0m in 0.02s]
[0m13:55:09.095533 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:55:09.095961 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:55:09.096323 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m13:55:09.096904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m13:55:09.097167 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:55:09.101121 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:55:09.101992 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 13:55:09.097324 => 13:55:09.101796
[0m13:55:09.102284 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:55:09.103983 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:55:09.104525 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:55:09.104824 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m13:55:09.105100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.110290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:09.110601 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:55:09.110927 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m13:55:09.111531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:55:09.112644 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 13:55:09.102462 => 13:55:09.112460
[0m13:55:09.112960 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m13:55:09.113365 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m13:55:09.114150 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_smart_meter_readings_reading_time ..................... [[32mPASS[0m in 0.02s]
[0m13:55:09.114897 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:55:09.115267 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:55:09.115628 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m13:55:09.116229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m13:55:09.116527 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:55:09.121234 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:55:09.122023 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 13:55:09.116748 => 13:55:09.121873
[0m13:55:09.122308 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:55:09.124076 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:55:09.124760 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:55:09.125090 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m13:55:09.125388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.130435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:55:09.130790 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:55:09.131097 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:55:09.131837 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:55:09.132999 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 13:55:09.122505 => 13:55:09.132820
[0m13:55:09.133343 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m13:55:09.133822 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m13:55:09.134488 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_households_household_id ................................. [[32mPASS[0m in 0.02s]
[0m13:55:09.135161 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:55:09.136872 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:09.137134 [debug] [MainThread]: On master: BEGIN
[0m13:55:09.137378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:09.142224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:55:09.142499 [debug] [MainThread]: On master: COMMIT
[0m13:55:09.142829 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:09.143081 [debug] [MainThread]: On master: COMMIT
[0m13:55:09.143405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:55:09.143700 [debug] [MainThread]: On master: Close
[0m13:55:09.144207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:09.144457 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m13:55:09.144923 [info ] [MainThread]: 
[0m13:55:09.145337 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:55:09.146379 [debug] [MainThread]: Command end result
[0m13:55:09.152351 [info ] [MainThread]: 
[0m13:55:09.152786 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:55:09.153171 [info ] [MainThread]: 
[0m13:55:09.153472 [error] [MainThread]: [31mFailure in test not_null_stg_households_household_id (models/schema.yml)[0m
[0m13:55:09.153797 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:55:09.154122 [info ] [MainThread]: 
[0m13:55:09.154416 [info ] [MainThread]:   compiled Code at target/compiled/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m13:55:09.154762 [info ] [MainThread]: 
[0m13:55:09.155204 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:55:09.156183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e8c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9adabf0>]}
[0m13:55:09.156500 [debug] [MainThread]: Flushing usage events
[0m13:59:27.041217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82de10>]}


============================== 13:59:27.052454 | 52b9067f-c14a-49ee-90e3-1cbd19aecfe0 ==============================
[0m13:59:27.052454 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:59:27.053224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:59:27.172225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bbee0>]}
[0m13:59:27.230652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d032b0>]}
[0m13:59:27.231322 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:59:27.238691 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:59:27.266163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:27.266549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:27.271218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afde40>]}
[0m13:59:27.281431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcac0>]}
[0m13:59:27.281842 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:59:27.282197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcb20>]}
[0m13:59:27.283753 [info ] [MainThread]: 
[0m13:59:27.284591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:27.286438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:59:27.294747 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:59:27.295090 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:59:27.295379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:27.332839 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:59:27.334285 [debug] [ThreadPool]: On list_analytics: Close
[0m13:59:27.336637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:59:27.340913 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:59:27.341202 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:59:27.341491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:27.346814 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:59:27.347129 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:59:27.347431 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:27.349758 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:59:27.350937 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:59:27.351305 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:59:27.354609 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:27.354943 [debug] [MainThread]: On master: BEGIN
[0m13:59:27.355181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:27.360200 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:27.360607 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:27.360961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:27.362732 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:59:27.363553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b3aa70>]}
[0m13:59:27.363929 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:27.364290 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:27.364556 [debug] [MainThread]: On master: BEGIN
[0m13:59:27.364954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:27.365212 [debug] [MainThread]: On master: COMMIT
[0m13:59:27.365527 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:27.365784 [debug] [MainThread]: On master: COMMIT
[0m13:59:27.366083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:27.366343 [debug] [MainThread]: On master: Close
[0m13:59:27.366864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:27.367314 [info ] [MainThread]: 
[0m13:59:27.373278 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m13:59:27.373708 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m13:59:27.374407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m13:59:27.374732 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m13:59:27.375115 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 13:59:27.374941 => 13:59:27.374943
[0m13:59:27.375391 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m13:59:27.396440 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:59:27.396822 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m13:59:27.397141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:27.402623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:27.402935 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:59:27.403261 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */

    create table "analytics"."public"."households" ("household_id" integer,"city" text,"meter_id" text,"installation_date" date)
  
[0m13:59:27.406780 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m13:59:27.424091 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:59:27.424470 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:59:27.425725 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m13:59:27.429545 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m13:59:27.442708 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:59:27.443025 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m13:59:27.443349 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m13:59:27.444404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:59:27.445348 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 13:59:27.375607 => 13:59:27.445185
[0m13:59:27.445666 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m13:59:27.446301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbc430>]}
[0m13:59:27.447099 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 11[0m in 0.07s]
[0m13:59:27.447811 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m13:59:27.448177 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m13:59:27.448631 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m13:59:27.449220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m13:59:27.449558 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m13:59:27.449923 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 13:59:27.449772 => 13:59:27.449773
[0m13:59:27.450198 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m13:59:27.498031 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:59:27.498393 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m13:59:27.498689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:27.503527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:27.503854 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:59:27.504140 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */

    create table "analytics"."public"."smart_meter_readings" ("meter_id" text,"reading_time" timestamp without time zone,"energy_kwh" float8,"voltage" float8,"current" float8)
  
[0m13:59:27.506615 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m13:59:28.568349 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:59:28.568827 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m13:59:28.582100 [debug] [Thread-1 (]: SQL status: INSERT 0 1442 in 0.0 seconds
[0m13:59:28.582918 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m13:59:28.585523 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:59:28.585871 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m13:59:28.586196 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m13:59:28.587030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:59:28.587779 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 13:59:27.450368 => 13:59:28.587609
[0m13:59:28.588079 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m13:59:28.588685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b82c20>]}
[0m13:59:28.589132 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1442[0m in 1.14s]
[0m13:59:28.589755 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m13:59:28.590151 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m13:59:28.590628 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m13:59:28.591255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m13:59:28.591575 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m13:59:28.591901 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 13:59:28.591754 => 13:59:28.591756
[0m13:59:28.592135 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m13:59:28.595360 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:59:28.595730 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m13:59:28.596103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:28.601214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:28.601626 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:59:28.601945 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */

    create table "analytics"."public"."tariff_rates" ("rate_id" integer,"start_date" date,"end_date" date,"price_per_kwh" float8)
  
[0m13:59:28.602797 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m13:59:28.605097 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:59:28.605393 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m13:59:28.605904 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m13:59:28.606486 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m13:59:28.608308 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:59:28.608603 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m13:59:28.608894 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m13:59:28.609461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:59:28.610077 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 13:59:28.592304 => 13:59:28.609946
[0m13:59:28.610333 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m13:59:28.610923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b9067f-c14a-49ee-90e3-1cbd19aecfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2d210>]}
[0m13:59:28.611364 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m13:59:28.611912 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m13:59:28.613651 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:28.613933 [debug] [MainThread]: On master: BEGIN
[0m13:59:28.614144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:28.619271 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:28.619636 [debug] [MainThread]: On master: COMMIT
[0m13:59:28.619911 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:28.620167 [debug] [MainThread]: On master: COMMIT
[0m13:59:28.620530 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:28.620779 [debug] [MainThread]: On master: Close
[0m13:59:28.621319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:28.621588 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m13:59:28.622021 [info ] [MainThread]: 
[0m13:59:28.622482 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m13:59:28.623281 [debug] [MainThread]: Command end result
[0m13:59:28.629906 [info ] [MainThread]: 
[0m13:59:28.630374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:28.630740 [info ] [MainThread]: 
[0m13:59:28.631167 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:59:28.632359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dde380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcbe0>]}
[0m13:59:28.632733 [debug] [MainThread]: Flushing usage events
[0m13:59:33.485434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 13:59:33.491382 | 53270adf-bee9-40f5-aa7d-6aa122c15cae ==============================
[0m13:59:33.491382 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:59:33.492208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:59:33.605787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53270adf-bee9-40f5-aa7d-6aa122c15cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m13:59:33.663117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53270adf-bee9-40f5-aa7d-6aa122c15cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfa9b0>]}
[0m13:59:33.663749 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:59:33.670940 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:59:33.693746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:33.694144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:33.698750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53270adf-bee9-40f5-aa7d-6aa122c15cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b01ed0>]}
[0m13:59:33.707289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53270adf-bee9-40f5-aa7d-6aa122c15cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca90>]}
[0m13:59:33.707693 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:59:33.708120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53270adf-bee9-40f5-aa7d-6aa122c15cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcc10>]}
[0m13:59:33.709776 [info ] [MainThread]: 
[0m13:59:33.710598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:33.712712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m13:59:33.721155 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:59:33.721498 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:59:33.721735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:33.755441 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.755850 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:59:33.756152 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:33.758008 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:59:33.759387 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:59:33.759796 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:59:33.764534 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:33.764848 [debug] [MainThread]: On master: BEGIN
[0m13:59:33.765095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:33.770118 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.770424 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:33.770757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:33.774606 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:59:33.775470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53270adf-bee9-40f5-aa7d-6aa122c15cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb716320>]}
[0m13:59:33.775834 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:33.776159 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:33.776451 [debug] [MainThread]: On master: BEGIN
[0m13:59:33.776880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.777130 [debug] [MainThread]: On master: COMMIT
[0m13:59:33.777425 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:33.777661 [debug] [MainThread]: On master: COMMIT
[0m13:59:33.777967 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:33.778213 [debug] [MainThread]: On master: Close
[0m13:59:33.778824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:33.779195 [info ] [MainThread]: 
[0m13:59:33.781729 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:59:33.782104 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m13:59:33.782762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m13:59:33.783090 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:59:33.794457 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:59:33.796249 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 13:59:33.783316 => 13:59:33.796075
[0m13:59:33.796549 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:59:33.806810 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:59:33.810160 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:59:33.811125 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m13:59:33.812312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:33.823265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.823830 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m13:59:33.824161 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m13:59:33.825147 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_households" does not exist
LINE 14: from "analytics"."public"."stg_households"
              ^

[0m13:59:33.825657 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m13:59:33.826272 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 13:59:33.796760 => 13:59:33.826083
[0m13:59:33.827053 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m13:59:33.832385 [debug] [Thread-1 (]: Database Error in test not_null_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m13:59:33.833337 [error] [Thread-1 (]: 1 of 5 ERROR not_null_stg_households_household_id .............................. [[31mERROR[0m in 0.05s]
[0m13:59:33.834008 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m13:59:33.834453 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:59:33.834855 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m13:59:33.835560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m13:59:33.835890 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:59:33.839221 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:59:33.840129 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 13:59:33.836089 => 13:59:33.839977
[0m13:59:33.840463 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:59:33.842382 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:59:33.843129 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:59:33.843477 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m13:59:33.843806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:33.849112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.849515 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m13:59:33.849802 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m13:59:33.850288 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_households" does not exist
LINE 14: from "analytics"."public"."stg_households"
              ^

[0m13:59:33.850583 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m13:59:33.851023 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 13:59:33.840647 => 13:59:33.850849
[0m13:59:33.851393 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m13:59:33.852549 [debug] [Thread-1 (]: Database Error in test not_null_stg_households_meter_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_meter_id.sql
[0m13:59:33.853029 [error] [Thread-1 (]: 2 of 5 ERROR not_null_stg_households_meter_id .................................. [[31mERROR[0m in 0.02s]
[0m13:59:33.853589 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m13:59:33.853941 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:59:33.854321 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m13:59:33.854929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m13:59:33.855249 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:59:33.858684 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:59:33.859644 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 13:59:33.855533 => 13:59:33.859420
[0m13:59:33.859978 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:59:33.862205 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:59:33.862987 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:59:33.863264 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m13:59:33.863515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:33.868778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.869177 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m13:59:33.869611 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m13:59:33.870121 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_smart_meter_readings" does not exist
LINE 14: from "analytics"."public"."stg_smart_meter_readings"
              ^

[0m13:59:33.870473 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m13:59:33.870993 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 13:59:33.860189 => 13:59:33.870783
[0m13:59:33.871404 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m13:59:33.872507 [debug] [Thread-1 (]: Database Error in test not_null_stg_smart_meter_readings_meter_id (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_meter_id.sql
[0m13:59:33.872979 [error] [Thread-1 (]: 3 of 5 ERROR not_null_stg_smart_meter_readings_meter_id ........................ [[31mERROR[0m in 0.02s]
[0m13:59:33.873571 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m13:59:33.873916 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:59:33.874313 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m13:59:33.874952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m13:59:33.875276 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:59:33.879285 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:59:33.880197 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 13:59:33.875534 => 13:59:33.880000
[0m13:59:33.880567 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:59:33.882545 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:59:33.883341 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:59:33.883688 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m13:59:33.883959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:33.889321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.889680 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m13:59:33.889951 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m13:59:33.890517 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_smart_meter_readings" does not exist
LINE 14: from "analytics"."public"."stg_smart_meter_readings"
              ^

[0m13:59:33.890928 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m13:59:33.891507 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 13:59:33.880871 => 13:59:33.891297
[0m13:59:33.891867 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m13:59:33.892897 [debug] [Thread-1 (]: Database Error in test not_null_stg_smart_meter_readings_reading_time (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_reading_time.sql
[0m13:59:33.893391 [error] [Thread-1 (]: 4 of 5 ERROR not_null_stg_smart_meter_readings_reading_time .................... [[31mERROR[0m in 0.02s]
[0m13:59:33.894046 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m13:59:33.894439 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:59:33.894828 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m13:59:33.895478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m13:59:33.895807 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:59:33.900545 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:59:33.901618 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 13:59:33.896021 => 13:59:33.901312
[0m13:59:33.902048 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:59:33.904109 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:59:33.904770 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:59:33.905127 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m13:59:33.905469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:33.910899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.911215 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m13:59:33.911532 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:59:33.912265 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_households" does not exist
LINE 15: from "analytics"."public"."stg_households"
              ^

[0m13:59:33.912686 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m13:59:33.913168 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 13:59:33.902318 => 13:59:33.912998
[0m13:59:33.913526 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m13:59:33.914522 [debug] [Thread-1 (]: Database Error in test unique_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 15: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/unique_stg_households_household_id.sql
[0m13:59:33.914970 [error] [Thread-1 (]: 5 of 5 ERROR unique_stg_households_household_id ................................ [[31mERROR[0m in 0.02s]
[0m13:59:33.915590 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m13:59:33.917408 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:33.917684 [debug] [MainThread]: On master: BEGIN
[0m13:59:33.917891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:33.922739 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:33.923079 [debug] [MainThread]: On master: COMMIT
[0m13:59:33.923373 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:33.923677 [debug] [MainThread]: On master: COMMIT
[0m13:59:33.924007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:33.924274 [debug] [MainThread]: On master: Close
[0m13:59:33.924833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:33.925093 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m13:59:33.925544 [info ] [MainThread]: 
[0m13:59:33.925930 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:59:33.926956 [debug] [MainThread]: Command end result
[0m13:59:33.933440 [info ] [MainThread]: 
[0m13:59:33.933977 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m13:59:33.934431 [info ] [MainThread]: 
[0m13:59:33.934830 [error] [MainThread]:   Database Error in test not_null_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m13:59:33.935200 [info ] [MainThread]: 
[0m13:59:33.935648 [error] [MainThread]:   Database Error in test not_null_stg_households_meter_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_meter_id.sql
[0m13:59:33.936005 [info ] [MainThread]: 
[0m13:59:33.936386 [error] [MainThread]:   Database Error in test not_null_stg_smart_meter_readings_meter_id (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_meter_id.sql
[0m13:59:33.936780 [info ] [MainThread]: 
[0m13:59:33.937130 [error] [MainThread]:   Database Error in test not_null_stg_smart_meter_readings_reading_time (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_reading_time.sql
[0m13:59:33.937515 [info ] [MainThread]: 
[0m13:59:33.937842 [error] [MainThread]:   Database Error in test unique_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 15: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/unique_stg_households_household_id.sql
[0m13:59:33.938171 [info ] [MainThread]: 
[0m13:59:33.938683 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m13:59:33.939637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbc430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcc70>]}
[0m13:59:33.939969 [debug] [MainThread]: Flushing usage events
[0m13:59:49.246113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dab0>]}


============================== 13:59:49.253013 | f3db1a58-d2b7-4b61-ae5b-0859424fbaa7 ==============================
[0m13:59:49.253013 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:59:49.253791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:49.367681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dba0>]}
[0m13:59:49.425816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8d90>]}
[0m13:59:49.426451 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m13:59:49.433605 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:59:49.456929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:49.457308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:49.462138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af9ea0>]}
[0m13:59:49.473039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8a60>]}
[0m13:59:49.473440 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:59:49.473830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8be0>]}
[0m13:59:49.475368 [info ] [MainThread]: 
[0m13:59:49.476143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:49.477995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m13:59:49.486318 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m13:59:49.486708 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:59:49.486974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:49.523265 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:59:49.524660 [debug] [ThreadPool]: On list_analytics: Close
[0m13:59:49.527158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m13:59:49.531224 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:59:49.531545 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m13:59:49.531829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:49.537148 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.537499 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m13:59:49.537795 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:49.539377 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:59:49.540732 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m13:59:49.541129 [debug] [ThreadPool]: On list_analytics_public: Close
[0m13:59:49.545322 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.545659 [debug] [MainThread]: On master: BEGIN
[0m13:59:49.545914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:49.550963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.551256 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.551629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:49.554933 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:59:49.555850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b328f0>]}
[0m13:59:49.556270 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:49.556637 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.556906 [debug] [MainThread]: On master: BEGIN
[0m13:59:49.557315 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.557612 [debug] [MainThread]: On master: COMMIT
[0m13:59:49.557892 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.558146 [debug] [MainThread]: On master: COMMIT
[0m13:59:49.558521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:49.558840 [debug] [MainThread]: On master: Close
[0m13:59:49.559519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:49.560105 [info ] [MainThread]: 
[0m13:59:49.563059 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m13:59:49.563606 [info ] [Thread-1 (]: 1 of 4 START sql table model public.stg_households ............................. [RUN]
[0m13:59:49.564370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m13:59:49.564764 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m13:59:49.570479 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m13:59:49.572999 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 13:59:49.565019 => 13:59:49.572805
[0m13:59:49.573343 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m13:59:49.602192 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m13:59:49.603322 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:59:49.603634 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m13:59:49.603896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:49.609363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.609700 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:59:49.609982 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m13:59:49.612224 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:59:49.617802 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:59:49.618188 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m13:59:49.618789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:49.631153 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:59:49.631559 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:59:49.631876 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m13:59:49.632544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:59:49.637372 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m13:59:49.640638 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m13:59:49.641044 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m13:59:49.641554 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:49.642695 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 13:59:49.573553 => 13:59:49.642543
[0m13:59:49.642976 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m13:59:49.643648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6b850>]}
[0m13:59:49.644545 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.stg_households ........................ [[32mSELECT 11[0m in 0.08s]
[0m13:59:49.645309 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m13:59:49.645762 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m13:59:49.646190 [info ] [Thread-1 (]: 2 of 4 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m13:59:49.646832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m13:59:49.647156 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m13:59:49.649377 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:59:49.650201 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 13:59:49.647393 => 13:59:49.650032
[0m13:59:49.650550 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m13:59:49.653584 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m13:59:49.654121 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:59:49.654411 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m13:59:49.654662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:49.660112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.660465 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:59:49.660832 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m13:59:49.663808 [debug] [Thread-1 (]: SQL status: SELECT 1442 in 0.0 seconds
[0m13:59:49.666687 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:59:49.667090 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m13:59:49.667611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:49.669034 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:59:49.669325 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:59:49.669609 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m13:59:49.670368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:59:49.672476 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m13:59:49.673165 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m13:59:49.673516 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m13:59:49.673981 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:49.675089 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 13:59:49.650743 => 13:59:49.674937
[0m13:59:49.675388 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m13:59:49.676036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bc39a0>]}
[0m13:59:49.676611 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1442[0m in 0.03s]
[0m13:59:49.677347 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m13:59:49.678784 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m13:59:49.679158 [info ] [Thread-1 (]: 3 of 4 START sql table model public.fct_daily_energy ........................... [RUN]
[0m13:59:49.679848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m13:59:49.680144 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m13:59:49.682789 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m13:59:49.684219 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 13:59:49.680365 => 13:59:49.684042
[0m13:59:49.684563 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m13:59:49.687834 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m13:59:49.688554 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:59:49.688894 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m13:59:49.689175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:49.694794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.695378 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:59:49.695896 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m13:59:49.699147 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m13:59:49.701882 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:59:49.702174 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m13:59:49.702636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:49.704819 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:59:49.705100 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:59:49.705360 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m13:59:49.706057 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:59:49.731201 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m13:59:49.732139 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m13:59:49.732513 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m13:59:49.733068 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:49.734173 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 13:59:49.684765 => 13:59:49.734025
[0m13:59:49.734507 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m13:59:49.735160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a223b0>]}
[0m13:59:49.735684 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 61[0m in 0.06s]
[0m13:59:49.736389 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m13:59:49.736833 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_energy_cost
[0m13:59:49.737247 [info ] [Thread-1 (]: 4 of 4 START sql table model public.fct_energy_cost ............................ [RUN]
[0m13:59:49.737865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_daily_energy, now model.energy_analytics.fct_energy_cost)
[0m13:59:49.738171 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_energy_cost
[0m13:59:49.740472 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_energy_cost"
[0m13:59:49.741344 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (compile): 13:59:49.738443 => 13:59:49.741144
[0m13:59:49.741661 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_energy_cost
[0m13:59:49.744726 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_energy_cost"
[0m13:59:49.745339 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m13:59:49.745661 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: BEGIN
[0m13:59:49.745931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:49.750959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.751277 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m13:59:49.751632 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */

  
    

  create  table "analytics"."public"."fct_energy_cost__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m13:59:49.754227 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m13:59:49.756667 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m13:59:49.756974 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
alter table "analytics"."public"."fct_energy_cost__dbt_tmp" rename to "fct_energy_cost"
[0m13:59:49.757363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:59:49.758641 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m13:59:49.758912 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m13:59:49.759150 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m13:59:49.759870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:59:49.761766 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_energy_cost__dbt_backup"
[0m13:59:49.762431 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m13:59:49.762749 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
drop table if exists "analytics"."public"."fct_energy_cost__dbt_backup" cascade
[0m13:59:49.763154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:59:49.764182 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (execute): 13:59:49.741849 => 13:59:49.764041
[0m13:59:49.764470 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: Close
[0m13:59:49.765060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3db1a58-d2b7-4b61-ae5b-0859424fbaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a23520>]}
[0m13:59:49.765547 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.fct_energy_cost ....................... [[32mSELECT 61[0m in 0.03s]
[0m13:59:49.766110 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_energy_cost
[0m13:59:49.767270 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.767550 [debug] [MainThread]: On master: BEGIN
[0m13:59:49.767821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:49.772813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:59:49.773095 [debug] [MainThread]: On master: COMMIT
[0m13:59:49.773366 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.773636 [debug] [MainThread]: On master: COMMIT
[0m13:59:49.773966 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:59:49.774229 [debug] [MainThread]: On master: Close
[0m13:59:49.774744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:49.774997 [debug] [MainThread]: Connection 'model.energy_analytics.fct_energy_cost' was properly closed.
[0m13:59:49.775500 [info ] [MainThread]: 
[0m13:59:49.775898 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:59:49.776859 [debug] [MainThread]: Command end result
[0m13:59:49.783692 [info ] [MainThread]: 
[0m13:59:49.784170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:49.784569 [info ] [MainThread]: 
[0m13:59:49.785018 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:59:49.785952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8c40>]}
[0m13:59:49.786252 [debug] [MainThread]: Flushing usage events
[0m14:01:48.514870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 14:01:48.522182 | 1c595684-741c-4255-8cb9-e4d8c3c56460 ==============================
[0m14:01:48.522182 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:01:48.523070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:01:48.639933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m14:01:48.697166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfe9b0>]}
[0m14:01:48.697824 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:01:48.706410 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:01:48.731800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:48.732327 [debug] [MainThread]: Partial parsing: updated file: energy_analytics://data/smart_meter_readings.csv
[0m14:01:48.813036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99fc0d0>]}
[0m14:01:48.823746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca90>]}
[0m14:01:48.824134 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:01:48.824502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcc10>]}
[0m14:01:48.826024 [info ] [MainThread]: 
[0m14:01:48.826835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:48.829042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:01:48.836993 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:01:48.837364 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:01:48.837630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:48.874756 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:01:48.876100 [debug] [ThreadPool]: On list_analytics: Close
[0m14:01:48.878494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:01:48.882578 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:48.882883 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:01:48.883179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:48.888410 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:01:48.888689 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:48.888964 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:01:48.890638 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:01:48.891642 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:01:48.891995 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:01:48.896424 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:48.896740 [debug] [MainThread]: On master: BEGIN
[0m14:01:48.897000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:48.901793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:48.902063 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:48.902438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:48.907072 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:01:48.907911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca74f0>]}
[0m14:01:48.908284 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:48.908627 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:48.908873 [debug] [MainThread]: On master: BEGIN
[0m14:01:48.909286 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:48.909539 [debug] [MainThread]: On master: COMMIT
[0m14:01:48.909785 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:48.910026 [debug] [MainThread]: On master: COMMIT
[0m14:01:48.910392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:48.910635 [debug] [MainThread]: On master: Close
[0m14:01:48.911177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:48.911547 [info ] [MainThread]: 
[0m14:01:48.913688 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m14:01:48.914126 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m14:01:48.914721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m14:01:48.915051 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m14:01:48.915488 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 14:01:48.915304 => 14:01:48.915306
[0m14:01:48.915793 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m14:01:48.937362 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:01:48.937770 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m14:01:48.938067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:48.943159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:48.943457 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:01:48.943756 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */
truncate table "analytics"."public"."households"
[0m14:01:48.946556 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:01:48.984477 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:01:48.984983 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:01:48.986835 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:01:48.990923 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m14:01:49.001087 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m14:01:49.001411 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:01:49.001675 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m14:01:49.003295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:49.004059 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 14:01:48.916004 => 14:01:49.003913
[0m14:01:49.004423 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m14:01:49.005108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a4af50>]}
[0m14:01:49.005894 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 11[0m in 0.09s]
[0m14:01:49.006643 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m14:01:49.007029 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m14:01:49.007472 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m14:01:49.008062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m14:01:49.008424 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m14:01:49.008785 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 14:01:49.008623 => 14:01:49.008624
[0m14:01:49.009049 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m14:01:49.052120 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:01:49.052487 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m14:01:49.052780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:49.057773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:49.058088 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:01:49.058425 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */
truncate table "analytics"."public"."smart_meter_readings"
[0m14:01:49.060795 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:01:50.146760 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:01:50.147347 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m14:01:50.159331 [debug] [Thread-1 (]: SQL status: INSERT 0 1442 in 0.0 seconds
[0m14:01:50.160092 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m14:01:50.163270 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m14:01:50.163603 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:01:50.163935 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m14:01:50.165041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:50.165749 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 14:01:49.009249 => 14:01:50.165605
[0m14:01:50.166049 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m14:01:50.166670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a49ed0>]}
[0m14:01:50.167193 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1442[0m in 1.16s]
[0m14:01:50.167928 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m14:01:50.168353 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m14:01:50.168776 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m14:01:50.169391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m14:01:50.169665 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m14:01:50.170033 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 14:01:50.169870 => 14:01:50.169872
[0m14:01:50.170349 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m14:01:50.174368 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:01:50.174765 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m14:01:50.175236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:50.180735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:50.181057 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:01:50.181406 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */
truncate table "analytics"."public"."tariff_rates"
[0m14:01:50.181948 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m14:01:50.184378 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:01:50.184693 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:01:50.185333 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m14:01:50.185929 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m14:01:50.187900 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m14:01:50.188251 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:01:50.188540 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m14:01:50.189528 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:50.190284 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 14:01:50.170539 => 14:01:50.190122
[0m14:01:50.190564 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m14:01:50.191194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c595684-741c-4255-8cb9-e4d8c3c56460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ad8d90>]}
[0m14:01:50.191948 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m14:01:50.192707 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m14:01:50.195250 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:50.195615 [debug] [MainThread]: On master: BEGIN
[0m14:01:50.195843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:50.201260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:50.201588 [debug] [MainThread]: On master: COMMIT
[0m14:01:50.201887 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:50.202149 [debug] [MainThread]: On master: COMMIT
[0m14:01:50.202502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:50.202777 [debug] [MainThread]: On master: Close
[0m14:01:50.203337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:50.203594 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m14:01:50.204042 [info ] [MainThread]: 
[0m14:01:50.204478 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m14:01:50.205374 [debug] [MainThread]: Command end result
[0m14:01:50.212179 [info ] [MainThread]: 
[0m14:01:50.212629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:50.212985 [info ] [MainThread]: 
[0m14:01:50.213447 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:01:50.214465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ac0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ac3310>]}
[0m14:01:50.214768 [debug] [MainThread]: Flushing usage events
[0m14:01:57.140265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 14:01:57.146580 | 6a578a55-d798-42f6-a175-7f87a054b959 ==============================
[0m14:01:57.146580 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:01:57.147408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:01:57.267665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m14:01:57.330185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8e80>]}
[0m14:01:57.330997 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:01:57.338987 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:01:57.365965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:57.366448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:57.371803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afded0>]}
[0m14:01:57.381498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca90>]}
[0m14:01:57.381988 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:01:57.382425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcc10>]}
[0m14:01:57.384074 [info ] [MainThread]: 
[0m14:01:57.384981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:57.387137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:01:57.396313 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:01:57.396833 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:01:57.397189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:57.433083 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:01:57.434600 [debug] [ThreadPool]: On list_analytics: Close
[0m14:01:57.436813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:01:57.441217 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:57.441552 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:01:57.441856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:57.447040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.447414 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:01:57.447716 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:01:57.448939 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:01:57.450273 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:01:57.450646 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:01:57.454988 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:57.455327 [debug] [MainThread]: On master: BEGIN
[0m14:01:57.455585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:57.460294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.460622 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:57.460958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:57.465349 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:01:57.466177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b36920>]}
[0m14:01:57.466545 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:57.466865 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:57.467148 [debug] [MainThread]: On master: BEGIN
[0m14:01:57.467555 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.467801 [debug] [MainThread]: On master: COMMIT
[0m14:01:57.468052 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:57.468344 [debug] [MainThread]: On master: COMMIT
[0m14:01:57.468685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:57.468930 [debug] [MainThread]: On master: Close
[0m14:01:57.469456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:57.469865 [info ] [MainThread]: 
[0m14:01:57.472029 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m14:01:57.472567 [info ] [Thread-1 (]: 1 of 4 START sql table model public.stg_households ............................. [RUN]
[0m14:01:57.473251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m14:01:57.473600 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m14:01:57.478878 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m14:01:57.480874 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 14:01:57.473837 => 14:01:57.480713
[0m14:01:57.481194 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m14:01:57.508776 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m14:01:57.509665 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:01:57.510000 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m14:01:57.510350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:57.515359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.515661 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:01:57.515918 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m14:01:57.518262 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:01:57.523380 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:01:57.523739 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households" rename to "stg_households__dbt_backup"
[0m14:01:57.524270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.526480 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:01:57.526766 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m14:01:57.527157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.541263 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m14:01:57.541588 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:01:57.541837 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m14:01:57.542288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:57.546713 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m14:01:57.549690 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:01:57.549989 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m14:01:57.551456 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:57.552514 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 14:01:57.481426 => 14:01:57.552360
[0m14:01:57.552825 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m14:01:57.553463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bc0250>]}
[0m14:01:57.554341 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.stg_households ........................ [[32mSELECT 11[0m in 0.08s]
[0m14:01:57.554997 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m14:01:57.555442 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m14:01:57.555863 [info ] [Thread-1 (]: 2 of 4 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m14:01:57.556487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m14:01:57.556771 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m14:01:57.558782 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.559467 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 14:01:57.556925 => 14:01:57.559293
[0m14:01:57.559740 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m14:01:57.562767 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.563281 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.563584 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m14:01:57.563863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:57.568879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.569200 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.569487 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m14:01:57.572033 [debug] [Thread-1 (]: SQL status: SELECT 1442 in 0.0 seconds
[0m14:01:57.574658 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.574982 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings" rename to "stg_smart_meter_readings__dbt_backup"
[0m14:01:57.575437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.577584 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.577878 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m14:01:57.578262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.579758 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m14:01:57.580027 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.580335 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m14:01:57.581212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:57.583177 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m14:01:57.583757 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:01:57.584020 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m14:01:57.585005 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:57.585956 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 14:01:57.559899 => 14:01:57.585814
[0m14:01:57.586271 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m14:01:57.586891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b60dc0>]}
[0m14:01:57.587376 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1442[0m in 0.03s]
[0m14:01:57.587966 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m14:01:57.589330 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m14:01:57.589669 [info ] [Thread-1 (]: 3 of 4 START sql table model public.fct_daily_energy ........................... [RUN]
[0m14:01:57.590367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m14:01:57.590653 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m14:01:57.592822 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m14:01:57.593804 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 14:01:57.590812 => 14:01:57.593640
[0m14:01:57.594076 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m14:01:57.620326 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m14:01:57.621398 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:01:57.621693 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m14:01:57.621976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:57.627179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.627475 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:01:57.627726 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m14:01:57.630604 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m14:01:57.633210 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:01:57.633586 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy" rename to "fct_daily_energy__dbt_backup"
[0m14:01:57.634196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.636285 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:01:57.636573 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m14:01:57.636901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.638328 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m14:01:57.638605 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:01:57.638884 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m14:01:57.639403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:57.641170 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m14:01:57.641770 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:01:57.642030 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m14:01:57.643114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:57.644236 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 14:01:57.594240 => 14:01:57.644078
[0m14:01:57.644543 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m14:01:57.645155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc2a25f0>]}
[0m14:01:57.645627 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 61[0m in 0.06s]
[0m14:01:57.646226 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m14:01:57.646592 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_energy_cost
[0m14:01:57.646980 [info ] [Thread-1 (]: 4 of 4 START sql table model public.fct_energy_cost ............................ [RUN]
[0m14:01:57.647588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_daily_energy, now model.energy_analytics.fct_energy_cost)
[0m14:01:57.647857 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_energy_cost
[0m14:01:57.650043 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_energy_cost"
[0m14:01:57.650972 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (compile): 14:01:57.648033 => 14:01:57.650809
[0m14:01:57.651269 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_energy_cost
[0m14:01:57.654176 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_energy_cost"
[0m14:01:57.654764 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:01:57.655040 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: BEGIN
[0m14:01:57.655318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:57.660250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.660549 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:01:57.660850 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */

  
    

  create  table "analytics"."public"."fct_energy_cost__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m14:01:57.663491 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m14:01:57.665920 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:01:57.666236 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
alter table "analytics"."public"."fct_energy_cost" rename to "fct_energy_cost__dbt_backup"
[0m14:01:57.666660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.669328 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:01:57.669605 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
alter table "analytics"."public"."fct_energy_cost__dbt_tmp" rename to "fct_energy_cost"
[0m14:01:57.669919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:57.671265 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m14:01:57.671536 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:01:57.671775 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m14:01:57.672400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:57.674315 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_energy_cost__dbt_backup"
[0m14:01:57.674855 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:01:57.675124 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
drop table if exists "analytics"."public"."fct_energy_cost__dbt_backup" cascade
[0m14:01:57.676020 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:57.677017 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (execute): 14:01:57.651439 => 14:01:57.676882
[0m14:01:57.677336 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: Close
[0m14:01:57.677929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a578a55-d798-42f6-a175-7f87a054b959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ba5780>]}
[0m14:01:57.678379 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.fct_energy_cost ....................... [[32mSELECT 61[0m in 0.03s]
[0m14:01:57.678901 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_energy_cost
[0m14:01:57.679987 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:57.680246 [debug] [MainThread]: On master: BEGIN
[0m14:01:57.680521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:57.685221 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:57.685481 [debug] [MainThread]: On master: COMMIT
[0m14:01:57.685689 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:57.685887 [debug] [MainThread]: On master: COMMIT
[0m14:01:57.686190 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:57.686471 [debug] [MainThread]: On master: Close
[0m14:01:57.687015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:57.687284 [debug] [MainThread]: Connection 'model.energy_analytics.fct_energy_cost' was properly closed.
[0m14:01:57.687758 [info ] [MainThread]: 
[0m14:01:57.688125 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:01:57.689002 [debug] [MainThread]: Command end result
[0m14:01:57.695425 [info ] [MainThread]: 
[0m14:01:57.695819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:57.696177 [info ] [MainThread]: 
[0m14:01:57.696609 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:01:57.697565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b60b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b63a90>]}
[0m14:01:57.697852 [debug] [MainThread]: Flushing usage events
[0m14:24:25.594257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82fb20>]}


============================== 14:24:25.603833 | 6bdcd7bd-a958-484d-8634-ef22f9e4b221 ==============================
[0m14:24:25.603833 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:24:25.604646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:25.722011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bbf40>]}
[0m14:24:25.780811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cff3d0>]}
[0m14:24:25.781510 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:24:25.790077 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:24:25.817184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:25.817571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:25.822260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af9ea0>]}
[0m14:24:25.833809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcb20>]}
[0m14:24:25.834197 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:24:25.834549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcb80>]}
[0m14:24:25.836030 [info ] [MainThread]: 
[0m14:24:25.836840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:25.838622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:24:25.846587 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:24:25.846952 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:24:25.847250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:25.884187 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:24:25.885528 [debug] [ThreadPool]: On list_analytics: Close
[0m14:24:25.888148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:24:25.892417 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:24:25.892723 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:24:25.892998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:25.898069 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:24:25.898360 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:24:25.898651 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:25.900521 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:24:25.901768 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:24:25.902195 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:24:25.905412 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:25.905777 [debug] [MainThread]: On master: BEGIN
[0m14:24:25.906029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:25.910508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:25.910810 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:25.911172 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:25.912733 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:24:25.913540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b36a10>]}
[0m14:24:25.914032 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:25.914405 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:25.914645 [debug] [MainThread]: On master: BEGIN
[0m14:24:25.915081 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:25.915349 [debug] [MainThread]: On master: COMMIT
[0m14:24:25.915603 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:25.915902 [debug] [MainThread]: On master: COMMIT
[0m14:24:25.916206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:25.916455 [debug] [MainThread]: On master: Close
[0m14:24:25.916995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:25.917466 [info ] [MainThread]: 
[0m14:24:25.922939 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m14:24:25.923382 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m14:24:25.924031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m14:24:25.924351 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m14:24:25.924773 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 14:24:25.924564 => 14:24:25.924566
[0m14:24:25.925106 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m14:24:25.945898 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:24:25.946319 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m14:24:25.946627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:25.951709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:25.952064 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:24:25.952360 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */

    create table "analytics"."public"."households" ("household_id" integer,"city" text,"meter_id" text,"installation_date" date)
  
[0m14:24:25.955748 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:24:25.972439 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:24:25.972776 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:24:25.974049 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:24:25.977998 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m14:24:25.990615 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m14:24:25.991085 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:24:25.991444 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m14:24:25.992307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:25.993276 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 14:24:25.925308 => 14:24:25.993126
[0m14:24:25.993539 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m14:24:25.994201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb5b40>]}
[0m14:24:25.994999 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 11[0m in 0.07s]
[0m14:24:25.995676 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m14:24:25.996060 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m14:24:25.996434 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m14:24:25.997021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m14:24:25.997291 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m14:24:25.997585 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 14:24:25.997450 => 14:24:25.997452
[0m14:24:25.997872 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m14:24:26.045471 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:24:26.045952 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m14:24:26.046240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:26.051205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:26.051510 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:24:26.051851 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */

    create table "analytics"."public"."smart_meter_readings" ("meter_id" text,"reading_time" timestamp without time zone,"energy_kwh" float8,"voltage" float8,"current" float8)
  
[0m14:24:26.054452 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:24:27.114365 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:24:27.114895 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m14:24:27.126436 [debug] [Thread-1 (]: SQL status: INSERT 0 1442 in 0.0 seconds
[0m14:24:27.127185 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m14:24:27.130528 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m14:24:27.130892 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:24:27.131183 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m14:24:27.132164 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:27.132886 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 14:24:25.998086 => 14:24:27.132712
[0m14:24:27.133172 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m14:24:27.133782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ca60>]}
[0m14:24:27.134213 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1442[0m in 1.14s]
[0m14:24:27.134807 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m14:24:27.135206 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m14:24:27.135635 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m14:24:27.136263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m14:24:27.136566 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m14:24:27.136949 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 14:24:27.136775 => 14:24:27.136777
[0m14:24:27.137228 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m14:24:27.140491 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:24:27.140858 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m14:24:27.141214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:27.146259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:27.146570 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:24:27.146899 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */

    create table "analytics"."public"."tariff_rates" ("rate_id" integer,"start_date" date,"end_date" date,"price_per_kwh" float8)
  
[0m14:24:27.147679 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:24:27.149972 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:24:27.150300 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:24:27.150829 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m14:24:27.151393 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m14:24:27.153202 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m14:24:27.153497 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:24:27.153781 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m14:24:27.154375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:27.155056 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 14:24:27.137426 => 14:24:27.154923
[0m14:24:27.155314 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m14:24:27.155916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bdcd7bd-a958-484d-8634-ef22f9e4b221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2bfd0>]}
[0m14:24:27.156342 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m14:24:27.156923 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m14:24:27.158546 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:27.158837 [debug] [MainThread]: On master: BEGIN
[0m14:24:27.159103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:27.164128 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:27.164476 [debug] [MainThread]: On master: COMMIT
[0m14:24:27.164735 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:27.165044 [debug] [MainThread]: On master: COMMIT
[0m14:24:27.165368 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:27.165622 [debug] [MainThread]: On master: Close
[0m14:24:27.166176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:27.166434 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m14:24:27.166916 [info ] [MainThread]: 
[0m14:24:27.167322 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m14:24:27.168140 [debug] [MainThread]: Command end result
[0m14:24:27.174518 [info ] [MainThread]: 
[0m14:24:27.174983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:27.175352 [info ] [MainThread]: 
[0m14:24:27.175839 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:24:27.176824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cff3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7ca60>]}
[0m14:24:27.177160 [debug] [MainThread]: Flushing usage events
[0m14:24:31.212827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dab0>]}


============================== 14:24:31.218853 | 341976f5-1d08-4859-bbde-1be004fbcd38 ==============================
[0m14:24:31.218853 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:24:31.219713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:24:31.333300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dba0>]}
[0m14:24:31.391120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfea70>]}
[0m14:24:31.391708 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:24:31.398721 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:24:31.421893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:31.422305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:31.426859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afdea0>]}
[0m14:24:31.436425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca60>]}
[0m14:24:31.436789 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:24:31.437135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcbe0>]}
[0m14:24:31.438575 [info ] [MainThread]: 
[0m14:24:31.439310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:31.441167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:24:31.449362 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:24:31.449678 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:24:31.449959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:31.484112 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:24:31.485480 [debug] [ThreadPool]: On list_analytics: Close
[0m14:24:31.487614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:24:31.491837 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:24:31.492146 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:24:31.492412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:31.497518 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.497849 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:24:31.498136 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:31.499494 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:24:31.500745 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:24:31.501127 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:24:31.505066 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.505388 [debug] [MainThread]: On master: BEGIN
[0m14:24:31.505634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:31.510268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.510546 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.510961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:31.514293 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:24:31.515103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b368f0>]}
[0m14:24:31.515453 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:31.515809 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.516052 [debug] [MainThread]: On master: BEGIN
[0m14:24:31.516462 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.516722 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.516973 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.517214 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.517518 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.517757 [debug] [MainThread]: On master: Close
[0m14:24:31.518284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:31.518644 [info ] [MainThread]: 
[0m14:24:31.520780 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m14:24:31.521241 [info ] [Thread-1 (]: 1 of 4 START sql table model public.stg_households ............................. [RUN]
[0m14:24:31.521921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m14:24:31.522234 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m14:24:31.527526 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m14:24:31.529617 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 14:24:31.522439 => 14:24:31.529439
[0m14:24:31.529930 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m14:24:31.556374 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m14:24:31.557206 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:24:31.557558 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m14:24:31.557856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:31.562794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.563105 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:24:31.563367 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m14:24:31.565147 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:24:31.569661 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:24:31.570034 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m14:24:31.570520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.582640 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m14:24:31.583005 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:24:31.583300 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m14:24:31.584042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.588701 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m14:24:31.591475 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:24:31.591760 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m14:24:31.592138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.593160 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 14:24:31.530133 => 14:24:31.593003
[0m14:24:31.593470 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m14:24:31.594109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6f850>]}
[0m14:24:31.594985 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.stg_households ........................ [[32mSELECT 11[0m in 0.07s]
[0m14:24:31.595737 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m14:24:31.596174 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m14:24:31.596577 [info ] [Thread-1 (]: 2 of 4 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m14:24:31.597215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m14:24:31.597521 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m14:24:31.599418 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:24:31.600228 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 14:24:31.597722 => 14:24:31.600074
[0m14:24:31.600482 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m14:24:31.603462 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:24:31.604024 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:24:31.604283 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m14:24:31.604509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:31.609390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.609733 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:24:31.610067 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m14:24:31.612384 [debug] [Thread-1 (]: SQL status: SELECT 1442 in 0.0 seconds
[0m14:24:31.614693 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:24:31.615026 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m14:24:31.615430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.616691 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m14:24:31.616965 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:24:31.617211 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m14:24:31.617918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.619837 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m14:24:31.620406 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:24:31.620696 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m14:24:31.621089 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.622034 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 14:24:31.600661 => 14:24:31.621877
[0m14:24:31.622307 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m14:24:31.622883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bc20e0>]}
[0m14:24:31.623336 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1442[0m in 0.03s]
[0m14:24:31.623902 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m14:24:31.625307 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m14:24:31.625627 [info ] [Thread-1 (]: 3 of 4 START sql table model public.fct_daily_energy ........................... [RUN]
[0m14:24:31.626256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m14:24:31.626543 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m14:24:31.628921 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m14:24:31.629914 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 14:24:31.626778 => 14:24:31.629739
[0m14:24:31.630190 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m14:24:31.633135 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m14:24:31.633754 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:24:31.634049 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m14:24:31.634317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:31.639390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.639699 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:24:31.640019 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m14:24:31.642863 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m14:24:31.645178 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:24:31.645445 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m14:24:31.645868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.647817 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m14:24:31.648122 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:24:31.648369 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m14:24:31.648847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.671523 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m14:24:31.672363 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:24:31.672706 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m14:24:31.673190 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.674227 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 14:24:31.630344 => 14:24:31.674090
[0m14:24:31.674533 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m14:24:31.675150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a223b0>]}
[0m14:24:31.675639 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 61[0m in 0.05s]
[0m14:24:31.676287 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m14:24:31.676624 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_energy_cost
[0m14:24:31.677094 [info ] [Thread-1 (]: 4 of 4 START sql table model public.fct_energy_cost ............................ [RUN]
[0m14:24:31.677703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_daily_energy, now model.energy_analytics.fct_energy_cost)
[0m14:24:31.678035 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_energy_cost
[0m14:24:31.680149 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_energy_cost"
[0m14:24:31.681353 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (compile): 14:24:31.678232 => 14:24:31.681198
[0m14:24:31.681633 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_energy_cost
[0m14:24:31.684569 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_energy_cost"
[0m14:24:31.685141 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:24:31.685433 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: BEGIN
[0m14:24:31.685702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:31.690800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.691117 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:24:31.691386 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */

  
    

  create  table "analytics"."public"."fct_energy_cost__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m14:24:31.693801 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m14:24:31.696608 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:24:31.696896 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
alter table "analytics"."public"."fct_energy_cost__dbt_tmp" rename to "fct_energy_cost"
[0m14:24:31.697381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:31.701012 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m14:24:31.701378 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:24:31.701615 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m14:24:31.702222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.704139 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_energy_cost__dbt_backup"
[0m14:24:31.704863 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:24:31.705194 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
drop table if exists "analytics"."public"."fct_energy_cost__dbt_backup" cascade
[0m14:24:31.705590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:24:31.706714 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (execute): 14:24:31.681832 => 14:24:31.706549
[0m14:24:31.707020 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: Close
[0m14:24:31.707635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '341976f5-1d08-4859-bbde-1be004fbcd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a23520>]}
[0m14:24:31.708138 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.fct_energy_cost ....................... [[32mSELECT 61[0m in 0.03s]
[0m14:24:31.708679 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_energy_cost
[0m14:24:31.709858 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.710126 [debug] [MainThread]: On master: BEGIN
[0m14:24:31.710334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:31.715294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:31.715562 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.715860 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.716116 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.716443 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:31.716698 [debug] [MainThread]: On master: Close
[0m14:24:31.717212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:31.717486 [debug] [MainThread]: Connection 'model.energy_analytics.fct_energy_cost' was properly closed.
[0m14:24:31.717953 [info ] [MainThread]: 
[0m14:24:31.718324 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:24:31.719230 [debug] [MainThread]: Command end result
[0m14:24:31.725172 [info ] [MainThread]: 
[0m14:24:31.725589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:31.725993 [info ] [MainThread]: 
[0m14:24:31.726419 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:24:31.727372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcc40>]}
[0m14:24:31.727673 [debug] [MainThread]: Flushing usage events
[0m14:25:06.109174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4df730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761c30>]}


============================== 14:25:06.115170 | d274b236-8e73-4811-8bde-e9a407bcb7a5 ==============================
[0m14:25:06.115170 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:25:06.116071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:25:06.231869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd274b236-8e73-4811-8bde-e9a407bcb7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f4dcf0>]}
[0m14:25:06.289521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd274b236-8e73-4811-8bde-e9a407bcb7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfe410>]}
[0m14:25:06.290165 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:25:06.297319 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:25:06.322419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:06.322764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:06.327388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd274b236-8e73-4811-8bde-e9a407bcb7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afa020>]}
[0m14:25:06.330922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd274b236-8e73-4811-8bde-e9a407bcb7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb4ca0>]}
[0m14:25:06.331289 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:25:06.331687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd274b236-8e73-4811-8bde-e9a407bcb7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb4d60>]}
[0m14:25:06.333230 [info ] [MainThread]: 
[0m14:25:06.333980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:06.336019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:25:06.344460 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:25:06.344789 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:25:06.345064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:06.380571 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:06.381030 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:25:06.381356 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:25:06.383170 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:25:06.384582 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:25:06.384958 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:25:06.390357 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:06.390693 [debug] [MainThread]: On master: BEGIN
[0m14:25:06.390955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:06.395761 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:06.396095 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:06.396431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:06.400624 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:25:06.401503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd274b236-8e73-4811-8bde-e9a407bcb7a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9caf7f0>]}
[0m14:25:06.401869 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:06.402201 [debug] [MainThread]: On master: Close
[0m14:25:06.402734 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:06.403142 [info ] [MainThread]: 
[0m14:25:06.405440 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m14:25:06.406004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m14:25:06.406306 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m14:25:06.411522 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m14:25:06.412311 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 14:25:06.406525 => 14:25:06.412153
[0m14:25:06.412602 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m14:25:06.412978 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 14:25:06.412808 => 14:25:06.412823
[0m14:25:06.413736 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m14:25:06.414131 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m14:25:06.414721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m14:25:06.415044 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m14:25:06.417475 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:25:06.418093 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 14:25:06.415230 => 14:25:06.417918
[0m14:25:06.418360 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m14:25:06.418686 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 14:25:06.418531 => 14:25:06.418538
[0m14:25:06.419299 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m14:25:06.419609 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m14:25:06.420233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now seed.energy_analytics.households)
[0m14:25:06.420509 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m14:25:06.421764 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 14:25:06.420693 => 14:25:06.421617
[0m14:25:06.422057 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m14:25:06.422395 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 14:25:06.422233 => 14:25:06.422242
[0m14:25:06.423081 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m14:25:06.423400 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m14:25:06.423973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m14:25:06.424374 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m14:25:06.425795 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 14:25:06.424586 => 14:25:06.425619
[0m14:25:06.426098 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m14:25:06.426446 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 14:25:06.426289 => 14:25:06.426295
[0m14:25:06.427113 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m14:25:06.427448 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m14:25:06.427977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m14:25:06.428299 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m14:25:06.429530 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 14:25:06.428488 => 14:25:06.429386
[0m14:25:06.429791 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m14:25:06.430145 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 14:25:06.429979 => 14:25:06.430002
[0m14:25:06.430743 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m14:25:06.431065 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:25:06.431533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.tariff_rates, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m14:25:06.431801 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:25:06.439863 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m14:25:06.441289 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 14:25:06.432012 => 14:25:06.441137
[0m14:25:06.441574 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:25:06.441910 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 14:25:06.441771 => 14:25:06.441777
[0m14:25:06.442539 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:25:06.442872 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:25:06.443382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m14:25:06.443646 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:25:06.446589 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m14:25:06.447201 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 14:25:06.443799 => 14:25:06.447029
[0m14:25:06.447475 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:25:06.447801 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 14:25:06.447632 => 14:25:06.447637
[0m14:25:06.448476 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:25:06.448777 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:25:06.449268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m14:25:06.449517 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:25:06.454115 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m14:25:06.454778 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 14:25:06.449665 => 14:25:06.454617
[0m14:25:06.455085 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:25:06.455423 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 14:25:06.455272 => 14:25:06.455278
[0m14:25:06.456017 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:25:06.456404 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m14:25:06.456921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.unique_stg_households_household_id.eaddff1e7e, now model.energy_analytics.fct_daily_energy)
[0m14:25:06.457221 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m14:25:06.459864 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m14:25:06.460485 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 14:25:06.457398 => 14:25:06.460332
[0m14:25:06.460767 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m14:25:06.461111 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 14:25:06.460957 => 14:25:06.460964
[0m14:25:06.461740 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m14:25:06.462070 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_energy_cost
[0m14:25:06.462560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_daily_energy, now model.energy_analytics.fct_energy_cost)
[0m14:25:06.462815 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_energy_cost
[0m14:25:06.464757 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_energy_cost"
[0m14:25:06.465339 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (compile): 14:25:06.462961 => 14:25:06.465174
[0m14:25:06.465599 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_energy_cost
[0m14:25:06.466020 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (execute): 14:25:06.465805 => 14:25:06.465812
[0m14:25:06.466743 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_energy_cost
[0m14:25:06.467148 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:25:06.467639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_energy_cost, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m14:25:06.467897 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:25:06.470774 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m14:25:06.471407 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 14:25:06.468090 => 14:25:06.471252
[0m14:25:06.471666 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:25:06.471947 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 14:25:06.471817 => 14:25:06.471822
[0m14:25:06.472617 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:25:06.472933 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:25:06.473455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m14:25:06.473736 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:25:06.476573 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m14:25:06.477179 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 14:25:06.473892 => 14:25:06.477022
[0m14:25:06.477458 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:25:06.477753 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 14:25:06.477624 => 14:25:06.477629
[0m14:25:06.478325 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:25:06.479696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:06.480024 [debug] [MainThread]: Connection 'test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6' was properly closed.
[0m14:25:06.481399 [debug] [MainThread]: Command end result
[0m14:25:06.490314 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:25:06.490588 [info ] [MainThread]: Building catalog
[0m14:25:06.492673 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:25:06.498135 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:25:06.498489 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:25:06.498821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:06.504116 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:06.504442 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:25:06.504855 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_smart_meter_readings')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('households')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('smart_meter_readings')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_daily_energy')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('tariff_rates')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_households')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_energy_cost')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:25:06.507116 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.0 seconds
[0m14:25:06.511360 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:25:06.511684 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:25:06.541016 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
[0m14:25:06.542160 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:25:06.542425 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:25:06.542669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4df730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d2aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bc4520>]}
[0m14:25:06.542941 [debug] [MainThread]: Flushing usage events
[0m14:25:25.412429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761ae0>]}


============================== 14:25:25.418533 | 41fde352-3736-46b5-a4e7-f16d3e2de43a ==============================
[0m14:25:25.418533 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:25:25.419327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m14:25:25.533491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41fde352-3736-46b5-a4e7-f16d3e2de43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761bd0>]}
[0m14:25:25.591984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41fde352-3736-46b5-a4e7-f16d3e2de43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf69b0>]}
[0m14:30:26.870322 [error] [MainThread]: Encountered an error:

[0m14:30:26.885474 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:30:26.893485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf53f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf4520>]}
[0m14:30:26.895462 [debug] [MainThread]: Flushing usage events
[0m14:30:57.520524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb82f730>]}


============================== 14:30:57.529220 | 379470dd-2c0d-447e-b01d-ffedb5f70224 ==============================
[0m14:30:57.529220 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:30:57.530093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:57.645659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb5bbe80>]}
[0m14:30:57.704383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcdab340>]}
[0m14:30:57.705026 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:30:57.713133 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:30:57.739426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:57.739884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:57.744445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af9de0>]}
[0m14:30:57.754783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbca60>]}
[0m14:30:57.755176 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:30:57.755525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcac0>]}
[0m14:30:57.757138 [info ] [MainThread]: 
[0m14:30:57.757975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:57.759891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:30:57.767912 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:30:57.768234 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:30:57.768470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:57.805499 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:30:57.807062 [debug] [ThreadPool]: On list_analytics: Close
[0m14:30:57.809251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:30:57.813373 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:30:57.813689 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:30:57.813967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:57.819010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:30:57.819299 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:30:57.819602 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:30:57.821073 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:30:57.822242 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:30:57.822619 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:30:57.825781 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:57.826097 [debug] [MainThread]: On master: BEGIN
[0m14:30:57.826365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:57.830841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:30:57.831124 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:57.831461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:57.832758 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:30:57.833507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b36a10>]}
[0m14:30:57.833879 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:57.834208 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:57.834518 [debug] [MainThread]: On master: BEGIN
[0m14:30:57.834926 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:30:57.835188 [debug] [MainThread]: On master: COMMIT
[0m14:30:57.835443 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:57.835685 [debug] [MainThread]: On master: COMMIT
[0m14:30:57.835989 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:30:57.836301 [debug] [MainThread]: On master: Close
[0m14:30:57.836839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:57.837246 [info ] [MainThread]: 
[0m14:30:57.842411 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m14:30:57.842857 [info ] [Thread-1 (]: 1 of 3 START seed file public.households ....................................... [RUN]
[0m14:30:57.843473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now seed.energy_analytics.households)
[0m14:30:57.843827 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m14:30:57.844314 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 14:30:57.844121 => 14:30:57.844122
[0m14:30:57.844605 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m14:30:57.866228 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:30:57.866643 [debug] [Thread-1 (]: On seed.energy_analytics.households: BEGIN
[0m14:30:57.866970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:57.871973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:30:57.872286 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:30:57.872617 [debug] [Thread-1 (]: On seed.energy_analytics.households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.households"} */

    create table "analytics"."public"."households" ("household_id" integer,"city" text,"meter_id" text,"installation_date" date)
  
[0m14:30:57.875089 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:30:57.891783 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:30:57.892151 [debug] [Thread-1 (]: On seed.energy_analytics.households: 
          insert into "analytics"."public"."households" ("household_id", "city", "meter_id", "installation_date") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:30:57.893319 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.0 seconds
[0m14:30:57.897391 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.households"
[0m14:30:57.910075 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m14:30:57.910506 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.households"
[0m14:30:57.910932 [debug] [Thread-1 (]: On seed.energy_analytics.households: COMMIT
[0m14:30:57.911520 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:30:57.912496 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 14:30:57.844810 => 14:30:57.912343
[0m14:30:57.912773 [debug] [Thread-1 (]: On seed.energy_analytics.households: Close
[0m14:30:57.913441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bb5a80>]}
[0m14:30:57.914263 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.households ................................... [[32mINSERT 11[0m in 0.07s]
[0m14:30:57.915044 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m14:30:57.915417 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m14:30:57.915827 [info ] [Thread-1 (]: 2 of 3 START seed file public.smart_meter_readings ............................. [RUN]
[0m14:30:57.916472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m14:30:57.916746 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m14:30:57.917111 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 14:30:57.916924 => 14:30:57.916925
[0m14:30:57.917448 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m14:30:57.966179 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:30:57.966580 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: BEGIN
[0m14:30:57.966909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:57.972016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:30:57.972377 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:30:57.972697 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.smart_meter_readings"} */

    create table "analytics"."public"."smart_meter_readings" ("meter_id" text,"reading_time" timestamp without time zone,"energy_kwh" float8,"voltage" float8,"current" float8)
  
[0m14:30:57.975351 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:30:59.031403 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:30:59.032032 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: 
          insert into "analytics"."public"."smart_meter_readings" ("meter_id", "reading_time", "energy_kwh", "voltage", "current") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s...
[0m14:30:59.044347 [debug] [Thread-1 (]: SQL status: INSERT 0 1442 in 0.0 seconds
[0m14:30:59.045097 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.smart_meter_readings"
[0m14:30:59.047005 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m14:30:59.047283 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.smart_meter_readings"
[0m14:30:59.047527 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: COMMIT
[0m14:30:59.048263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:30:59.048976 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 14:30:57.917673 => 14:30:59.048822
[0m14:30:59.049267 [debug] [Thread-1 (]: On seed.energy_analytics.smart_meter_readings: Close
[0m14:30:59.049881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b7cf40>]}
[0m14:30:59.050344 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.smart_meter_readings ......................... [[32mINSERT 1442[0m in 1.13s]
[0m14:30:59.050919 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m14:30:59.051283 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m14:30:59.051670 [info ] [Thread-1 (]: 3 of 3 START seed file public.tariff_rates ..................................... [RUN]
[0m14:30:59.052267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m14:30:59.052565 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m14:30:59.052905 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 14:30:59.052739 => 14:30:59.052740
[0m14:30:59.053201 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m14:30:59.056408 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:30:59.056671 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: BEGIN
[0m14:30:59.056969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:59.062133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:30:59.062464 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:30:59.062769 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "seed.energy_analytics.tariff_rates"} */

    create table "analytics"."public"."tariff_rates" ("rate_id" integer,"start_date" date,"end_date" date,"price_per_kwh" float8)
  
[0m14:30:59.063552 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m14:30:59.065820 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:30:59.066149 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: 
          insert into "analytics"."public"."tariff_rates" ("rate_id", "start_date", "end_date", "price_per_kwh") values
          (%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m14:30:59.066653 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m14:30:59.067255 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.energy_analytics.tariff_rates"
[0m14:30:59.069218 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m14:30:59.069511 [debug] [Thread-1 (]: Using postgres connection "seed.energy_analytics.tariff_rates"
[0m14:30:59.069808 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: COMMIT
[0m14:30:59.070389 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:30:59.071115 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 14:30:59.053381 => 14:30:59.070964
[0m14:30:59.071377 [debug] [Thread-1 (]: On seed.energy_analytics.tariff_rates: Close
[0m14:30:59.071952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379470dd-2c0d-447e-b01d-ffedb5f70224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b377c0>]}
[0m14:30:59.072366 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.tariff_rates ................................. [[32mINSERT 2[0m in 0.02s]
[0m14:30:59.072886 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m14:30:59.074611 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:59.074878 [debug] [MainThread]: On master: BEGIN
[0m14:30:59.075123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:59.079870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:30:59.080268 [debug] [MainThread]: On master: COMMIT
[0m14:30:59.080535 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:59.080781 [debug] [MainThread]: On master: COMMIT
[0m14:30:59.081157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:30:59.081421 [debug] [MainThread]: On master: Close
[0m14:30:59.081943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:59.082186 [debug] [MainThread]: Connection 'seed.energy_analytics.tariff_rates' was properly closed.
[0m14:30:59.082623 [info ] [MainThread]: 
[0m14:30:59.082978 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m14:30:59.083761 [debug] [MainThread]: Command end result
[0m14:30:59.089983 [info ] [MainThread]: 
[0m14:30:59.090484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:59.090863 [info ] [MainThread]: 
[0m14:30:59.091334 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:30:59.092346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd51b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b3da80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbcb80>]}
[0m14:30:59.092636 [debug] [MainThread]: Flushing usage events
[0m14:31:03.944227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>]}


============================== 14:31:03.950328 | f36d00bc-7f5c-46f8-be15-3625a9c52b08 ==============================
[0m14:31:03.950328 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:31:03.951133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:31:04.063254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f36d00bc-7f5c-46f8-be15-3625a9c52b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dbd0>]}
[0m14:31:04.120811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f36d00bc-7f5c-46f8-be15-3625a9c52b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfe9b0>]}
[0m14:31:04.121416 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:31:04.128644 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:31:04.151447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:04.151879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:04.156630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f36d00bc-7f5c-46f8-be15-3625a9c52b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b01ed0>]}
[0m14:31:04.165178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f36d00bc-7f5c-46f8-be15-3625a9c52b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc0a90>]}
[0m14:31:04.165608 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:31:04.165978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f36d00bc-7f5c-46f8-be15-3625a9c52b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc0c10>]}
[0m14:31:04.167591 [info ] [MainThread]: 
[0m14:31:04.168361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:04.170532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:31:04.179174 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:31:04.179510 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:31:04.179731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:04.214465 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.214924 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:31:04.215271 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:31:04.216824 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:31:04.218260 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:31:04.218673 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:31:04.223463 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:04.223825 [debug] [MainThread]: On master: BEGIN
[0m14:31:04.224105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:04.228920 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.229227 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:04.229610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:31:04.232740 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:31:04.233611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f36d00bc-7f5c-46f8-be15-3625a9c52b08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb712320>]}
[0m14:31:04.234043 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:04.234372 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:04.234653 [debug] [MainThread]: On master: BEGIN
[0m14:31:04.235077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.235351 [debug] [MainThread]: On master: COMMIT
[0m14:31:04.235608 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:04.235864 [debug] [MainThread]: On master: COMMIT
[0m14:31:04.236221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:31:04.236496 [debug] [MainThread]: On master: Close
[0m14:31:04.237047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:31:04.237432 [info ] [MainThread]: 
[0m14:31:04.239954 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:04.240402 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_households_household_id ......................... [RUN]
[0m14:31:04.241168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m14:31:04.241522 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:04.253531 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m14:31:04.255792 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 14:31:04.241732 => 14:31:04.255609
[0m14:31:04.256190 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:04.266729 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m14:31:04.268220 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m14:31:04.268634 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: BEGIN
[0m14:31:04.268989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:04.274022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.274364 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m14:31:04.274638 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select household_id
from "analytics"."public"."stg_households"
where household_id is null



      
    ) dbt_internal_test
[0m14:31:04.275410 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_households" does not exist
LINE 14: from "analytics"."public"."stg_households"
              ^

[0m14:31:04.275698 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: ROLLBACK
[0m14:31:04.276178 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 14:31:04.256423 => 14:31:04.276007
[0m14:31:04.276456 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_household_id.8e711e894e: Close
[0m14:31:04.278245 [debug] [Thread-1 (]: Database Error in test not_null_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m14:31:04.278964 [error] [Thread-1 (]: 1 of 5 ERROR not_null_stg_households_household_id .............................. [[31mERROR[0m in 0.04s]
[0m14:31:04.279695 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:04.280177 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:04.280646 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_households_meter_id ............................. [RUN]
[0m14:31:04.281329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m14:31:04.281654 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:04.284841 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m14:31:04.285627 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 14:31:04.281866 => 14:31:04.285468
[0m14:31:04.285916 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:04.287653 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m14:31:04.288235 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m14:31:04.288510 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: BEGIN
[0m14:31:04.288800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:04.293851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.294185 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m14:31:04.294444 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_households"
where meter_id is null



      
    ) dbt_internal_test
[0m14:31:04.294903 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_households" does not exist
LINE 14: from "analytics"."public"."stg_households"
              ^

[0m14:31:04.295196 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: ROLLBACK
[0m14:31:04.295616 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 14:31:04.286185 => 14:31:04.295452
[0m14:31:04.295926 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83: Close
[0m14:31:04.296946 [debug] [Thread-1 (]: Database Error in test not_null_stg_households_meter_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_meter_id.sql
[0m14:31:04.297490 [error] [Thread-1 (]: 2 of 5 ERROR not_null_stg_households_meter_id .................................. [[31mERROR[0m in 0.02s]
[0m14:31:04.298161 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:04.298566 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:04.298957 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_smart_meter_readings_meter_id ................... [RUN]
[0m14:31:04.299612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m14:31:04.299886 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:04.303230 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m14:31:04.304059 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 14:31:04.300098 => 14:31:04.303889
[0m14:31:04.304381 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:04.306137 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m14:31:04.306783 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m14:31:04.307121 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: BEGIN
[0m14:31:04.307386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:04.312454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.312752 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m14:31:04.313072 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select meter_id
from "analytics"."public"."stg_smart_meter_readings"
where meter_id is null



      
    ) dbt_internal_test
[0m14:31:04.313526 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_smart_meter_readings" does not exist
LINE 14: from "analytics"."public"."stg_smart_meter_readings"
              ^

[0m14:31:04.313818 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: ROLLBACK
[0m14:31:04.314296 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 14:31:04.304614 => 14:31:04.314120
[0m14:31:04.314592 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c: Close
[0m14:31:04.315593 [debug] [Thread-1 (]: Database Error in test not_null_stg_smart_meter_readings_meter_id (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_meter_id.sql
[0m14:31:04.316147 [error] [Thread-1 (]: 3 of 5 ERROR not_null_stg_smart_meter_readings_meter_id ........................ [[31mERROR[0m in 0.02s]
[0m14:31:04.316817 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:04.317301 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:04.317678 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_smart_meter_readings_reading_time ............... [RUN]
[0m14:31:04.318320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m14:31:04.318653 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:04.322569 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m14:31:04.323375 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 14:31:04.318865 => 14:31:04.323215
[0m14:31:04.323659 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:04.325439 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m14:31:04.326153 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m14:31:04.326470 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: BEGIN
[0m14:31:04.326946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:04.332879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.333316 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m14:31:04.333698 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select reading_time
from "analytics"."public"."stg_smart_meter_readings"
where reading_time is null



      
    ) dbt_internal_test
[0m14:31:04.334348 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_smart_meter_readings" does not exist
LINE 14: from "analytics"."public"."stg_smart_meter_readings"
              ^

[0m14:31:04.334824 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: ROLLBACK
[0m14:31:04.335507 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 14:31:04.323873 => 14:31:04.335255
[0m14:31:04.335932 [debug] [Thread-1 (]: On test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6: Close
[0m14:31:04.337066 [debug] [Thread-1 (]: Database Error in test not_null_stg_smart_meter_readings_reading_time (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_reading_time.sql
[0m14:31:04.337541 [error] [Thread-1 (]: 4 of 5 ERROR not_null_stg_smart_meter_readings_reading_time .................... [[31mERROR[0m in 0.02s]
[0m14:31:04.338198 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:04.338586 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:04.339026 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_households_household_id ........................... [RUN]
[0m14:31:04.339705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m14:31:04.340079 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:04.345255 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m14:31:04.346360 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 14:31:04.340305 => 14:31:04.346142
[0m14:31:04.346699 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:04.348620 [debug] [Thread-1 (]: Writing runtime sql for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m14:31:04.349349 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m14:31:04.349643 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: BEGIN
[0m14:31:04.349931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:04.355389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.355866 [debug] [Thread-1 (]: Using postgres connection "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m14:31:04.356261 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    household_id as unique_field,
    count(*) as n_records

from "analytics"."public"."stg_households"
where household_id is not null
group by household_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:31:04.356839 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_households" does not exist
LINE 15: from "analytics"."public"."stg_households"
              ^

[0m14:31:04.357197 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: ROLLBACK
[0m14:31:04.357876 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 14:31:04.346966 => 14:31:04.357579
[0m14:31:04.358355 [debug] [Thread-1 (]: On test.energy_analytics.unique_stg_households_household_id.eaddff1e7e: Close
[0m14:31:04.359660 [debug] [Thread-1 (]: Database Error in test unique_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 15: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/unique_stg_households_household_id.sql
[0m14:31:04.360291 [error] [Thread-1 (]: 5 of 5 ERROR unique_stg_households_household_id ................................ [[31mERROR[0m in 0.02s]
[0m14:31:04.361035 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:04.362779 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:04.363113 [debug] [MainThread]: On master: BEGIN
[0m14:31:04.363385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:04.368911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:04.369329 [debug] [MainThread]: On master: COMMIT
[0m14:31:04.369654 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:04.369952 [debug] [MainThread]: On master: COMMIT
[0m14:31:04.370360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:31:04.370671 [debug] [MainThread]: On master: Close
[0m14:31:04.371285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:04.371601 [debug] [MainThread]: Connection 'test.energy_analytics.unique_stg_households_household_id.eaddff1e7e' was properly closed.
[0m14:31:04.372082 [info ] [MainThread]: 
[0m14:31:04.372452 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:31:04.373609 [debug] [MainThread]: Command end result
[0m14:31:04.380296 [info ] [MainThread]: 
[0m14:31:04.380885 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m14:31:04.381293 [info ] [MainThread]: 
[0m14:31:04.381660 [error] [MainThread]:   Database Error in test not_null_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_household_id.sql
[0m14:31:04.382071 [info ] [MainThread]: 
[0m14:31:04.382448 [error] [MainThread]:   Database Error in test not_null_stg_households_meter_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 14: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_households_meter_id.sql
[0m14:31:04.382802 [info ] [MainThread]: 
[0m14:31:04.383172 [error] [MainThread]:   Database Error in test not_null_stg_smart_meter_readings_meter_id (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_meter_id.sql
[0m14:31:04.383557 [info ] [MainThread]: 
[0m14:31:04.383979 [error] [MainThread]:   Database Error in test not_null_stg_smart_meter_readings_reading_time (models/schema.yml)
  relation "public.stg_smart_meter_readings" does not exist
  LINE 14: from "analytics"."public"."stg_smart_meter_readings"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/not_null_stg_smart_meter_readings_reading_time.sql
[0m14:31:04.384355 [info ] [MainThread]: 
[0m14:31:04.384792 [error] [MainThread]:   Database Error in test unique_stg_households_household_id (models/schema.yml)
  relation "public.stg_households" does not exist
  LINE 15: from "analytics"."public"."stg_households"
                ^
  compiled Code at target/run/energy_analytics/models/schema.yml/unique_stg_households_household_id.sql
[0m14:31:04.385196 [info ] [MainThread]: 
[0m14:31:04.385682 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m14:31:04.386639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc0c70>]}
[0m14:31:04.386964 [debug] [MainThread]: Flushing usage events
[0m14:31:10.397280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75da80>]}


============================== 14:31:10.403355 | 88a707dc-000b-494a-8ba2-36e4ed035b5e ==============================
[0m14:31:10.403355 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:31:10.404213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:31:10.523892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb75db70>]}
[0m14:31:10.580927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cf8220>]}
[0m14:31:10.581558 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:31:10.588781 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:31:10.611703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:10.612106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:10.616690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af9e70>]}
[0m14:31:10.626807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8a30>]}
[0m14:31:10.627229 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:31:10.627750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8bb0>]}
[0m14:31:10.629165 [info ] [MainThread]: 
[0m14:31:10.629927 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:10.631733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m14:31:10.639958 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m14:31:10.640345 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:31:10.640642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:10.675883 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:31:10.677186 [debug] [ThreadPool]: On list_analytics: Close
[0m14:31:10.679190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_public)
[0m14:31:10.683191 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:31:10.683501 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:31:10.683828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:10.688879 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.689208 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:31:10.689498 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:31:10.690713 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:31:10.691959 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:31:10.692312 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:31:10.696335 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:10.696643 [debug] [MainThread]: On master: BEGIN
[0m14:31:10.696901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:10.701639 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.701937 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:10.702271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:31:10.705339 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:31:10.706206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b328c0>]}
[0m14:31:10.706578 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:10.706921 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:10.707186 [debug] [MainThread]: On master: BEGIN
[0m14:31:10.707614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.707885 [debug] [MainThread]: On master: COMMIT
[0m14:31:10.708170 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:10.708419 [debug] [MainThread]: On master: COMMIT
[0m14:31:10.708723 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:31:10.708990 [debug] [MainThread]: On master: Close
[0m14:31:10.709516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:31:10.709856 [info ] [MainThread]: 
[0m14:31:10.712014 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m14:31:10.712454 [info ] [Thread-1 (]: 1 of 4 START sql table model public.stg_households ............................. [RUN]
[0m14:31:10.713105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m14:31:10.713432 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m14:31:10.718895 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m14:31:10.719905 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 14:31:10.713648 => 14:31:10.719667
[0m14:31:10.720259 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m14:31:10.747774 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_households"
[0m14:31:10.749072 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:31:10.749392 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: BEGIN
[0m14:31:10.749685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:10.754868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.755193 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:31:10.755495 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */

  
    

  create  table "analytics"."public"."stg_households__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_households.sql
SELECT
  household_id,
  city,
  meter_id,
  installation_date
FROM "analytics"."public"."households"
  );
  
[0m14:31:10.757718 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:31:10.762294 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:31:10.762623 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
alter table "analytics"."public"."stg_households__dbt_tmp" rename to "stg_households"
[0m14:31:10.763089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:10.775231 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m14:31:10.775596 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:31:10.775921 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: COMMIT
[0m14:31:10.776687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:31:10.781721 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_households__dbt_backup"
[0m14:31:10.784840 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_households"
[0m14:31:10.785153 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_households"} */
drop table if exists "analytics"."public"."stg_households__dbt_backup" cascade
[0m14:31:10.785542 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:10.786601 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 14:31:10.720470 => 14:31:10.786445
[0m14:31:10.786956 [debug] [Thread-1 (]: On model.energy_analytics.stg_households: Close
[0m14:31:10.787590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6b820>]}
[0m14:31:10.788444 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.stg_households ........................ [[32mSELECT 11[0m in 0.07s]
[0m14:31:10.789226 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m14:31:10.789622 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m14:31:10.790052 [info ] [Thread-1 (]: 2 of 4 START sql table model public.stg_smart_meter_readings ................... [RUN]
[0m14:31:10.790630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m14:31:10.790974 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m14:31:10.792849 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:10.793641 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 14:31:10.791175 => 14:31:10.793479
[0m14:31:10.793925 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m14:31:10.796912 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:10.797451 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:10.797708 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: BEGIN
[0m14:31:10.797963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:10.802729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.803081 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:10.803392 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */

  
    

  create  table "analytics"."public"."stg_smart_meter_readings__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_smart_meter_readings.sql
SELECT
  meter_id,
  reading_time,
  energy_kwh,
  voltage,
  current
FROM "analytics"."public"."smart_meter_readings"
  );
  
[0m14:31:10.805627 [debug] [Thread-1 (]: SQL status: SELECT 1442 in 0.0 seconds
[0m14:31:10.807960 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:10.808265 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
alter table "analytics"."public"."stg_smart_meter_readings__dbt_tmp" rename to "stg_smart_meter_readings"
[0m14:31:10.808640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:10.810015 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m14:31:10.810300 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:10.810562 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: COMMIT
[0m14:31:10.811308 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:31:10.813269 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."stg_smart_meter_readings__dbt_backup"
[0m14:31:10.814040 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:10.814927 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.stg_smart_meter_readings"} */
drop table if exists "analytics"."public"."stg_smart_meter_readings__dbt_backup" cascade
[0m14:31:10.815456 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:10.816736 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 14:31:10.794101 => 14:31:10.816581
[0m14:31:10.817071 [debug] [Thread-1 (]: On model.energy_analytics.stg_smart_meter_readings: Close
[0m14:31:10.817710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9adbd30>]}
[0m14:31:10.818267 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.stg_smart_meter_readings .............. [[32mSELECT 1442[0m in 0.03s]
[0m14:31:10.818847 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m14:31:10.820227 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m14:31:10.820546 [info ] [Thread-1 (]: 3 of 4 START sql table model public.fct_daily_energy ........................... [RUN]
[0m14:31:10.821133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now model.energy_analytics.fct_daily_energy)
[0m14:31:10.821405 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m14:31:10.823657 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m14:31:10.824630 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 14:31:10.821561 => 14:31:10.824467
[0m14:31:10.824891 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m14:31:10.828074 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_daily_energy"
[0m14:31:10.828649 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:31:10.828911 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: BEGIN
[0m14:31:10.829147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:10.834103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.834483 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:31:10.834831 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */

  
    

  create  table "analytics"."public"."fct_daily_energy__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m14:31:10.838013 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m14:31:10.840508 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:31:10.840809 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
alter table "analytics"."public"."fct_daily_energy__dbt_tmp" rename to "fct_daily_energy"
[0m14:31:10.841285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:10.843476 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m14:31:10.843751 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:31:10.844103 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: COMMIT
[0m14:31:10.844669 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:31:10.867126 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_daily_energy__dbt_backup"
[0m14:31:10.867991 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_daily_energy"
[0m14:31:10.868333 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_daily_energy"} */
drop table if exists "analytics"."public"."fct_daily_energy__dbt_backup" cascade
[0m14:31:10.868883 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:10.869984 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 14:31:10.825094 => 14:31:10.869833
[0m14:31:10.870307 [debug] [Thread-1 (]: On model.energy_analytics.fct_daily_energy: Close
[0m14:31:10.870957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a26380>]}
[0m14:31:10.871467 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.fct_daily_energy ...................... [[32mSELECT 61[0m in 0.05s]
[0m14:31:10.872137 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m14:31:10.872514 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_energy_cost
[0m14:31:10.872932 [info ] [Thread-1 (]: 4 of 4 START sql table model public.fct_energy_cost ............................ [RUN]
[0m14:31:10.873568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_daily_energy, now model.energy_analytics.fct_energy_cost)
[0m14:31:10.873880 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_energy_cost
[0m14:31:10.876125 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_energy_cost"
[0m14:31:10.877084 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (compile): 14:31:10.874153 => 14:31:10.876902
[0m14:31:10.877381 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_energy_cost
[0m14:31:10.880451 [debug] [Thread-1 (]: Writing runtime sql for node "model.energy_analytics.fct_energy_cost"
[0m14:31:10.881000 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:31:10.881254 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: BEGIN
[0m14:31:10.881483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:10.886453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.886750 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:31:10.887056 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */

  
    

  create  table "analytics"."public"."fct_energy_cost__dbt_tmp"
  
  
    as
  
  (
    -- models/fact/fct_daily_energy.sql
SELECT
  h.city,
  h.household_id,
  DATE(r.reading_time) AS reading_date,
  SUM(r.energy_kwh) AS daily_energy_kwh,
  AVG(r.voltage) AS avg_voltage,
  AVG(r.current) AS avg_current
FROM "analytics"."public"."stg_smart_meter_readings" r
JOIN "analytics"."public"."stg_households" h
  ON r.meter_id = h.meter_id
GROUP BY 1, 2, 3
  );
  
[0m14:31:10.889536 [debug] [Thread-1 (]: SQL status: SELECT 61 in 0.0 seconds
[0m14:31:10.891948 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:31:10.892273 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
alter table "analytics"."public"."fct_energy_cost__dbt_tmp" rename to "fct_energy_cost"
[0m14:31:10.892692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:31:10.894142 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m14:31:10.894463 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:31:10.894747 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: COMMIT
[0m14:31:10.895323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:31:10.897210 [debug] [Thread-1 (]: Applying DROP to: "analytics"."public"."fct_energy_cost__dbt_backup"
[0m14:31:10.897775 [debug] [Thread-1 (]: Using postgres connection "model.energy_analytics.fct_energy_cost"
[0m14:31:10.898095 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "node_id": "model.energy_analytics.fct_energy_cost"} */
drop table if exists "analytics"."public"."fct_energy_cost__dbt_backup" cascade
[0m14:31:10.898467 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:31:10.899460 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (execute): 14:31:10.877601 => 14:31:10.899323
[0m14:31:10.899732 [debug] [Thread-1 (]: On model.energy_analytics.fct_energy_cost: Close
[0m14:31:10.900330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a707dc-000b-494a-8ba2-36e4ed035b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a274f0>]}
[0m14:31:10.900780 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.fct_energy_cost ....................... [[32mSELECT 61[0m in 0.03s]
[0m14:31:10.901387 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_energy_cost
[0m14:31:10.902536 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:10.902782 [debug] [MainThread]: On master: BEGIN
[0m14:31:10.903050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:10.907813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:10.908096 [debug] [MainThread]: On master: COMMIT
[0m14:31:10.908346 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:10.908590 [debug] [MainThread]: On master: COMMIT
[0m14:31:10.908892 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:31:10.909160 [debug] [MainThread]: On master: Close
[0m14:31:10.909634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:10.909918 [debug] [MainThread]: Connection 'model.energy_analytics.fct_energy_cost' was properly closed.
[0m14:31:10.910362 [info ] [MainThread]: 
[0m14:31:10.910737 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:31:10.911734 [debug] [MainThread]: Command end result
[0m14:31:10.918148 [info ] [MainThread]: 
[0m14:31:10.918672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:10.919148 [info ] [MainThread]: 
[0m14:31:10.919615 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:31:10.920590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4dec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff99dcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ca7e20>]}
[0m14:31:10.920954 [debug] [MainThread]: Flushing usage events
[0m14:31:27.974272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761ba0>]}


============================== 14:31:27.980438 | ca527a2b-3efc-4440-8152-c17fc4265f77 ==============================
[0m14:31:27.980438 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:31:27.981221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:31:28.095073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca527a2b-3efc-4440-8152-c17fc4265f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f06e00>]}
[0m14:31:28.152130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca527a2b-3efc-4440-8152-c17fc4265f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cff550>]}
[0m14:31:28.152716 [info ] [MainThread]: Registered adapter: postgres=1.7.7
[0m14:31:28.159748 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:31:28.183658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:28.184033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:28.188676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca527a2b-3efc-4440-8152-c17fc4265f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afdf90>]}
[0m14:31:28.192571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca527a2b-3efc-4440-8152-c17fc4265f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8c10>]}
[0m14:31:28.192953 [info ] [MainThread]: Found 3 seeds, 4 models, 5 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:31:28.193374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca527a2b-3efc-4440-8152-c17fc4265f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb8cd0>]}
[0m14:31:28.195084 [info ] [MainThread]: 
[0m14:31:28.195925 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:28.198001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics_public'
[0m14:31:28.206378 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:31:28.206695 [debug] [ThreadPool]: On list_analytics_public: BEGIN
[0m14:31:28.206987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:28.241036 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:31:28.241433 [debug] [ThreadPool]: Using postgres connection "list_analytics_public"
[0m14:31:28.241741 [debug] [ThreadPool]: On list_analytics_public: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:31:28.243538 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:31:28.244959 [debug] [ThreadPool]: On list_analytics_public: ROLLBACK
[0m14:31:28.245331 [debug] [ThreadPool]: On list_analytics_public: Close
[0m14:31:28.250592 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:28.250924 [debug] [MainThread]: On master: BEGIN
[0m14:31:28.251188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:28.256129 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:31:28.256446 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:28.256835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:31:28.261281 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:31:28.262232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca527a2b-3efc-4440-8152-c17fc4265f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9caf670>]}
[0m14:31:28.262617 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:28.262955 [debug] [MainThread]: On master: Close
[0m14:31:28.263513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:31:28.264015 [info ] [MainThread]: 
[0m14:31:28.266290 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_households
[0m14:31:28.266890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_public, now model.energy_analytics.stg_households)
[0m14:31:28.267245 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_households
[0m14:31:28.272691 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_households"
[0m14:31:28.273523 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (compile): 14:31:28.267466 => 14:31:28.273339
[0m14:31:28.273849 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_households
[0m14:31:28.274222 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_households (execute): 14:31:28.274056 => 14:31:28.274071
[0m14:31:28.274997 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_households
[0m14:31:28.275381 [debug] [Thread-1 (]: Began running node model.energy_analytics.stg_smart_meter_readings
[0m14:31:28.276031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_households, now model.energy_analytics.stg_smart_meter_readings)
[0m14:31:28.276381 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.stg_smart_meter_readings
[0m14:31:28.278642 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.stg_smart_meter_readings"
[0m14:31:28.279711 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (compile): 14:31:28.276585 => 14:31:28.279546
[0m14:31:28.280034 [debug] [Thread-1 (]: Began executing node model.energy_analytics.stg_smart_meter_readings
[0m14:31:28.280368 [debug] [Thread-1 (]: Timing info for model.energy_analytics.stg_smart_meter_readings (execute): 14:31:28.280227 => 14:31:28.280233
[0m14:31:28.280979 [debug] [Thread-1 (]: Finished running node model.energy_analytics.stg_smart_meter_readings
[0m14:31:28.281302 [debug] [Thread-1 (]: Began running node seed.energy_analytics.households
[0m14:31:28.281925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.stg_smart_meter_readings, now seed.energy_analytics.households)
[0m14:31:28.282218 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.households
[0m14:31:28.283449 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (compile): 14:31:28.282413 => 14:31:28.283297
[0m14:31:28.283732 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.households
[0m14:31:28.284107 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.households (execute): 14:31:28.283931 => 14:31:28.283937
[0m14:31:28.284839 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.households
[0m14:31:28.285271 [debug] [Thread-1 (]: Began running node seed.energy_analytics.smart_meter_readings
[0m14:31:28.285827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.households, now seed.energy_analytics.smart_meter_readings)
[0m14:31:28.286189 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.smart_meter_readings
[0m14:31:28.287475 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (compile): 14:31:28.286374 => 14:31:28.287318
[0m14:31:28.287767 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.smart_meter_readings
[0m14:31:28.288164 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.smart_meter_readings (execute): 14:31:28.287982 => 14:31:28.287988
[0m14:31:28.288771 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.smart_meter_readings
[0m14:31:28.289127 [debug] [Thread-1 (]: Began running node seed.energy_analytics.tariff_rates
[0m14:31:28.289672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.smart_meter_readings, now seed.energy_analytics.tariff_rates)
[0m14:31:28.289970 [debug] [Thread-1 (]: Began compiling node seed.energy_analytics.tariff_rates
[0m14:31:28.291201 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (compile): 14:31:28.290181 => 14:31:28.291053
[0m14:31:28.291482 [debug] [Thread-1 (]: Began executing node seed.energy_analytics.tariff_rates
[0m14:31:28.291847 [debug] [Thread-1 (]: Timing info for seed.energy_analytics.tariff_rates (execute): 14:31:28.291681 => 14:31:28.291687
[0m14:31:28.292461 [debug] [Thread-1 (]: Finished running node seed.energy_analytics.tariff_rates
[0m14:31:28.292780 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:28.293285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.energy_analytics.tariff_rates, now test.energy_analytics.not_null_stg_households_household_id.8e711e894e)
[0m14:31:28.293578 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:28.301977 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_household_id.8e711e894e"
[0m14:31:28.302979 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (compile): 14:31:28.293776 => 14:31:28.302826
[0m14:31:28.303274 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:28.303593 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_household_id.8e711e894e (execute): 14:31:28.303453 => 14:31:28.303457
[0m14:31:28.304281 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_household_id.8e711e894e
[0m14:31:28.304584 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:28.305096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_household_id.8e711e894e, now test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83)
[0m14:31:28.305364 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:28.308317 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83"
[0m14:31:28.308944 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (compile): 14:31:28.305538 => 14:31:28.308768
[0m14:31:28.309225 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:28.309559 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83 (execute): 14:31:28.309397 => 14:31:28.309403
[0m14:31:28.310190 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83
[0m14:31:28.310490 [debug] [Thread-1 (]: Began running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:28.310996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_households_meter_id.dc524d0f83, now test.energy_analytics.unique_stg_households_household_id.eaddff1e7e)
[0m14:31:28.311252 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:28.315745 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.unique_stg_households_household_id.eaddff1e7e"
[0m14:31:28.316487 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (compile): 14:31:28.311410 => 14:31:28.316324
[0m14:31:28.316754 [debug] [Thread-1 (]: Began executing node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:28.317118 [debug] [Thread-1 (]: Timing info for test.energy_analytics.unique_stg_households_household_id.eaddff1e7e (execute): 14:31:28.316960 => 14:31:28.316966
[0m14:31:28.317717 [debug] [Thread-1 (]: Finished running node test.energy_analytics.unique_stg_households_household_id.eaddff1e7e
[0m14:31:28.318075 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_daily_energy
[0m14:31:28.318594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.unique_stg_households_household_id.eaddff1e7e, now model.energy_analytics.fct_daily_energy)
[0m14:31:28.318855 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_daily_energy
[0m14:31:28.321625 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_daily_energy"
[0m14:31:28.322201 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (compile): 14:31:28.319020 => 14:31:28.322053
[0m14:31:28.322451 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_daily_energy
[0m14:31:28.322741 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_daily_energy (execute): 14:31:28.322602 => 14:31:28.322606
[0m14:31:28.323408 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_daily_energy
[0m14:31:28.323715 [debug] [Thread-1 (]: Began running node model.energy_analytics.fct_energy_cost
[0m14:31:28.324188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_daily_energy, now model.energy_analytics.fct_energy_cost)
[0m14:31:28.324481 [debug] [Thread-1 (]: Began compiling node model.energy_analytics.fct_energy_cost
[0m14:31:28.326504 [debug] [Thread-1 (]: Writing injected SQL for node "model.energy_analytics.fct_energy_cost"
[0m14:31:28.327049 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (compile): 14:31:28.324664 => 14:31:28.326896
[0m14:31:28.327343 [debug] [Thread-1 (]: Began executing node model.energy_analytics.fct_energy_cost
[0m14:31:28.327652 [debug] [Thread-1 (]: Timing info for model.energy_analytics.fct_energy_cost (execute): 14:31:28.327512 => 14:31:28.327516
[0m14:31:28.328318 [debug] [Thread-1 (]: Finished running node model.energy_analytics.fct_energy_cost
[0m14:31:28.328636 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:28.329133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.energy_analytics.fct_energy_cost, now test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c)
[0m14:31:28.329504 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:28.332594 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c"
[0m14:31:28.333296 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (compile): 14:31:28.329702 => 14:31:28.333133
[0m14:31:28.333562 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:28.333890 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c (execute): 14:31:28.333722 => 14:31:28.333727
[0m14:31:28.334533 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c
[0m14:31:28.334847 [debug] [Thread-1 (]: Began running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:28.335350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.energy_analytics.not_null_stg_smart_meter_readings_meter_id.4d4b15ec9c, now test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6)
[0m14:31:28.335612 [debug] [Thread-1 (]: Began compiling node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:28.338261 [debug] [Thread-1 (]: Writing injected SQL for node "test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6"
[0m14:31:28.338842 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (compile): 14:31:28.335764 => 14:31:28.338658
[0m14:31:28.339147 [debug] [Thread-1 (]: Began executing node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:28.339463 [debug] [Thread-1 (]: Timing info for test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6 (execute): 14:31:28.339327 => 14:31:28.339332
[0m14:31:28.340039 [debug] [Thread-1 (]: Finished running node test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6
[0m14:31:28.341382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:28.341616 [debug] [MainThread]: Connection 'test.energy_analytics.not_null_stg_smart_meter_readings_reading_time.da8660c9a6' was properly closed.
[0m14:31:28.343017 [debug] [MainThread]: Command end result
[0m14:31:28.352245 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:31:28.352499 [info ] [MainThread]: Building catalog
[0m14:31:28.354488 [debug] [ThreadPool]: Acquiring new postgres connection 'analytics.information_schema'
[0m14:31:28.360161 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:31:28.360489 [debug] [ThreadPool]: On analytics.information_schema: BEGIN
[0m14:31:28.360716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:28.365863 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:31:28.366130 [debug] [ThreadPool]: Using postgres connection "analytics.information_schema"
[0m14:31:28.366477 [debug] [ThreadPool]: On analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "default", "target_name": "dev", "connection_name": "analytics.information_schema"} */

    
    

    select
        'analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_households')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('smart_meter_readings')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_daily_energy')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_energy_cost')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('households')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('tariff_rates')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_smart_meter_readings')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:31:28.368281 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.0 seconds
[0m14:31:28.372430 [debug] [ThreadPool]: On analytics.information_schema: ROLLBACK
[0m14:31:28.372770 [debug] [ThreadPool]: On analytics.information_schema: Close
[0m14:31:28.401997 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
[0m14:31:28.403156 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:31:28.403407 [debug] [MainThread]: Connection 'analytics.information_schema' was properly closed.
[0m14:31:28.403639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bc5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bc69b0>]}
[0m14:31:28.403908 [debug] [MainThread]: Flushing usage events
[0m14:31:36.198300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761ae0>]}


============================== 14:31:36.204390 | 2d8a6c55-f010-4897-8af5-04f24bdcaa36 ==============================
[0m14:31:36.204390 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:31:36.205212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:31:36.320462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d8a6c55-f010-4897-8af5-04f24bdcaa36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb761bd0>]}
[0m14:31:36.378776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d8a6c55-f010-4897-8af5-04f24bdcaa36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cfa9b0>]}
